(()=>{var t={627:(t,e,r)=>{t=r.nmd(t);try{process.dlopen(t,r(928).join(__dirname,r.p,"8c0d713d94b87197578f9913475daeeb.node"))}catch(t){throw new Error("node-loader:\n"+t)}},928:t=>{"use strict";t.exports=require("path")}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.p="";var n={};(()=>{"use strict";r.r(n),r.d(n,{Cost:()=>bo,Dataset:()=>mo,DatasetBuilder:()=>vo,DatasetBuilderSource:()=>wo,DatasetModifier:()=>ho,Layer:()=>yo,Math:()=>rt,NetworkBuilder:()=>so,Optimizer:()=>po,Trainer:()=>kr,default:()=>go});var t=r(627),e=r.n(t),o=new(e().Device.CPU),i=function(){return o};function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function c(t,e,r){return(e=l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"_result",null),c(this,"_params",null)}return e=t,r=[{key:"setResult",value:function(t){return this._result=t,this}},{key:"setParams",value:function(t){return this._params=t,this}},{key:"execSync",value:function(t,e){return this.exec(t,e)(this._params,this._result),this}},{key:"execAsync",value:function(t,e){var r=this;return new Promise(function(n){r.exec(t,e,!0)(r._params,r._result).then(function(){n(r)})})}},{key:"exec",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var n=i().loadModule(t).loadFunction(e);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n.execute((t||[]).map(function(t){return t.getMemory()}),(e||[]).map(function(t){return t.getMemory()}),r)}}catch(t){return console.error(t),function(){}}}}],n=[{key:"get",value:function(){return new t}}],r&&a(e.prototype,r),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function b(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}var m=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,"_dims",[]),b(this,"_allocated",!1),b(this,"_memory",null),b(this,"_device",null),this._dims=[e,r,n],this._device=i()},e=[{key:"dims",value:function(){return this._dims}},{key:"rows",value:function(){return this._dims[0]}},{key:"cols",value:function(){return this._dims[1]}},{key:"depth",value:function(){return this._dims[2]}},{key:"count",value:function(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,a=[],c=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this._dims,3);return t[0]*t[1]*t[2]}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._dims=[t,e,r],this.allocate(),this}},{key:"allocate",value:function(){return this._allocated||(this._memory=this._device.alloc(this.count()),this._memory.setWidth(this.rows()),this._memory.setHeight(this.cols()),this._memory.setDepth(this.depth()),this._allocated=!0),this}},{key:"set",value:function(t){return this._memory.set(new Float64Array(t)),this}},{key:"get",value:function(){return this._memory.get()}},{key:"isScalar",value:function(){return!1}},{key:"isRowVector",value:function(){return!1}},{key:"isColVector",value:function(){return!1}},{key:"isMatrix2D",value:function(){return!1}},{key:"isMatrix3D",value:function(){return!1}},{key:"setZeros",value:function(){return this.calcSync(function(t){return t.setZeros()})}},{key:"setRandom",value:function(t){return this.calcSync(function(e){return e.setRandom(t)})}},{key:"setMax",value:function(t){return this.calcSync(function(e){return e.setMax(t)})}},{key:"setMin",value:function(t){return this.calcSync(function(e){return e.setMin(t)})}},{key:"reluBackpropagation",value:function(){return this.calcSync(function(t){return t.reluBackpropagation()})}},{key:"pow",value:function(t){return this.calcSync(function(e){return e.pow(t)})}},{key:"sum",value:function(){return this.calcSync(function(t){return t.sum()})}},{key:"reluForwardPropagation",value:function(){return this.calcSync(function(t){return t.reluForwardPropagation()})}},{key:"getCalcSandbox",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{sum:function(){var r=(new S).allocate();return t._call("algebra","algebra_sum",e)([t,r])(r)},setZeros:function(){return t._call("matrix","matrix_set_zeros",e)([t])(t)},setRandom:function(r){var n=(new S).allocate().set([r]);return t._call("matrix","matrix_set_random",e)([t,n])(t)}}}},{key:"_call",value:function(t,e,r){return function(n,o){var i=f.get().setResult(o).setParams(n);return function(n){return r?new Promise(function(r){i.execAsync(t,e).then(function(){r(n)})}):(i.execSync(t,e),n)}}}},{key:"calcSync",value:function(t){return t(this.getCalcSandbox(!1))}},{key:"calcAsync",value:function(t){var e=this;return new Promise(function(r,n){try{r(t(e.getCalcSandbox(!0)))}catch(t){n(t)}})}},{key:"getMemory",value:function(){return this._memory}},{key:Symbol.dispose,value:function(){this._memory.free()}},{key:"destroy",value:function(){this._memory.free(),this._dims=[0,0,0],this._allocated=!1}},{key:"copyFrom",value:function(t){return this._allocated&&this.destroy(),this._dims=t.dims(),this.allocate(),this._memory.setWidth(t.rows()),this._memory.setHeight(t.cols()),this._memory.setDepth(t.depth()),this._memory.copyFrom(t.getMemory()),this._dims=t.dims(),this}},{key:"replace",value:function(t){return this.rows()!==t.rows()||this.cols()!==t.cols()||this.depth()!==t.depth()?(this.destroy(),this.copyFrom(t)):this._memory.copyFrom(t.getMemory()),t.destroy(),this}}],e&&p(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t){if("object"!=h(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==h(e)?e:e+""}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(g=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}var S=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=O(e),function(t,e){if(e&&("object"==h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}(this,e,[1])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),r=e,(n=[{key:"isScalar",value:function(){return!0}}])&&w(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(m);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(E=function(){return!!t})()}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}var R=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=T(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],T(t).constructor):e.apply(t,r))}(this,e,[1,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(e,t),r=e,o=[{key:"fromMemory",value:function(t,r){var n=new e(r);return n._memory=t,n._allocated=!0,n}}],(n=[{key:"isColVector",value:function(){return!0}}])&&_(r.prototype,n),o&&_(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(m);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function W(t){var e=function(t){if("object"!=B(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:e+""}function C(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(C=function(){return!!t})()}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z(t)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}var A=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=z(e),function(t,e){if(e&&("object"==B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,C()?Reflect.construct(e,r||[],z(t).constructor):e.apply(t,r))}(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(e,t),r=e,(n=[{key:"isRowVector",value:function(){return!0}},{key:"transpose",value:function(){return R.fromMemory(this.getMemory().clone(),this.rows())}}])&&D(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(m);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach(function(e){Z(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Z(t,e,r){return(e=q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,q(n.key),n)}}function q(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}function I(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(I=function(){return!!t})()}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=U(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},V.apply(null,arguments)}function U(t){return U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},U(t)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}var $=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=U(e),function(t,e){if(e&&("object"==L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,I()?Reflect.construct(e,r||[],U(t).constructor):e.apply(t,r))}(this,e,[t,r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(e,t),r=e,n=[{key:"isMatrix2D",value:function(){return!0}},{key:"row",value:function(t){var r=new e(1,this.cols()).allocate();return this._call("matrix","matrix_row",!1)([this,(new S).allocate().set(new Float64Array([t])),r])(r)}},{key:"col",value:function(t){var r=new e(this.rows(),1).allocate();return this._call("matrix","matrix_col",!1)([this,(new S).allocate().set(new Float64Array([t])),r])(r)}},{key:"maxCoeff",value:function(){return this.calcSync(function(t){return t.maxCoeff()})}},{key:"add",value:function(t){return this.calcSync(function(e){return e.add(t)})}},{key:"forwardPropagation",value:function(t,e){return this.calcSync(function(r){return r.forwardPropagation(t,e)})}},{key:"backwardPropagation",value:function(t,e,r,n){return this.calcSync(function(o){return o.backwardPropagation(t,e,r,n)})}},{key:"transpose",value:function(){return this.calcSync(function(t){return t.transpose()})}},{key:"logisticForwardPropagation",value:function(){return this.calcSync(function(t){return t.logisticForwardPropagation()})}},{key:"logisticBackwardPropagation",value:function(){return this.calcSync(function(t){return t.logisticBackwardPropagation()})}},{key:"pow",value:function(t){return this.calcSync(function(e){return e.pow(t)})}},{key:"multiply",value:function(t){return this.calcSync(function(e){return e.multiply(t)})}},{key:"divide",value:function(t){return this.calcSync(function(e){return e.divide(t)})}},{key:"subtract",value:function(t){return this.calcSync(function(e){return e.subtract(t)})}},{key:"crossEntropyLoss",value:function(t,e,r){return this.calcSync(function(n){return n.crossEntropyLoss(t,e,r)})}},{key:"crossEntropyDerivative",value:function(t,e,r){return this.calcSync(function(n){return n.crossEntropyDerivative(t,e,r)})}},{key:"softmax",value:function(){return this.calcSync(function(t){return t.softmax()})}},{key:"tanh",value:function(){return this.calcSync(function(t){return t.tanh()})}},{key:"tanhDerivative",value:function(){return this.calcSync(function(t){return t.tanhDerivative()})}},{key:"block",value:function(t,e,r,n){return this.calcSync(function(o){return o.block(t,e,r,n)})}},{key:"softmaxDerivative",value:function(){return this.calcSync(function(t){return t.softmaxDerivative()})}},{key:"minMax",value:function(){return this.calcSync(function(t){return t.minMax()})}},{key:"getCalcSandbox",value:function(){var t,r,n,o=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=(t=e,r=this,"function"==typeof(n=V(U(1&3?t.prototype:t),"getCalcSandbox",r))?function(t){return n.apply(r,t)}:n)([i]),a=this;return H(H({},u),{},{crossEntropyLoss:function(t,e,r){var n=(new S).allocate().set([r]),o=(new S).allocate();return a._call("algebra","algebra_cross_entropy_loss",i)([t,e,n],[o])(o)},crossEntropyDerivative:function(t,r,n){var o=(new S).allocate().set([n]),u=new e(t.rows(),t.cols()).allocate();return a._call("algebra","algebra_cross_entropy_derivative",i)([t,r,o],[u])(u)},block:function(t,r,n,o){var u=new e(n,o).allocate(),c=(new S).allocate().set([t]),l=(new S).allocate().set([r]),f=(new S).allocate().set([n]),s=(new S).allocate().set([o]);return a._call("matrix","matrix_block",i)([a,c,l,f,s,u])(u)},forwardPropagation:function(t,r){var n=new e(t.rows(),o.cols()).allocate();return a._call("algebra","algebra_forward_propagation",i)([t,o,r,n])(n)},backwardPropagation:function(t,r,n,u){var c=new e(t.rows(),t.cols()).allocate(),l=new e(t.rows(),1).allocate(),f=new e(r.rows(),r.cols()).allocate(),s=(new S).allocate().set([n]),y=(new S).allocate().set([u]);return a._call("algebra","algebra_backward_propagation",i)([o,t,r,s,y,c,l,f])([c,l,f])},pow:function(t){var r=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_pow",i)([o,(new S).allocate().set([t]),r])(r)},fraction:function(t){var r=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_fraction",i)([o,(new S).allocate().set([t]),r])(r)},softmax:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_softmax",i)([o,t])(t)},sqrt:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_sqrt",i)([o,t])(t)},tanh:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_tanh",i)([o,t])(t)},tanhDerivative:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_tanh_derivative",i)([o,t])(t)},softmaxDerivative:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_softmax_derivative",i)([o,t])(t)},rowwiseSum:function(){var t=new e(o.rows(),1).allocate();return a._call("algebra","algebra_rowwise_sum",i)([o,t])(t)},multiply:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_multiply_number",i)([o,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_multiply",i)([o,t,u])(u)},log:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_log",i)([o,t])(t)},divide:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_divide_number",i)([o,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_divide_matrix",i)([o,t,u])(u)},dot:function(t){var r=new e(o.rows(),t.cols()).allocate();return a._call("algebra","algebra_dot",i)([o,t,r])(r)},add:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_add_number",i)([o,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_add_matrix",i)([o,t,u])(u)},subtract:function(t){var r=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_subtract",i)([o,t,r])(r)},transpose:function(){var t=new e(o.cols(),o.rows()).allocate();return a._call("matrix","matrix_transpose",i)([o,t])(t)},logMinusOne:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_log_minus_one",i)([o,t])(t)},minusOne:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_minus_one",i)([o,t])(t)},logisticForwardPropagation:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_logistic_forward_propagation",i)([o,t])(t)},conjugate:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_conjugate",i)([o,t])(t)},logisticBackwardPropagation:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_logistic_backward_propagation",i)([o,t])(t)},leakyRelu:function(t){var r=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_leaky_relu",i)([o,(new S).allocate().set([t]),r])(r)},leakyReluBackpropagation:function(t){var r=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_leaky_reluBackpropagation",i)([o,(new S).allocate().set([t]),r])(r)},maxCoeff:function(){var t=(new S).allocate();return a._call("algebra","algebra_max_coeff",i)([o,t])(t)},setMin:function(t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return a._call("matrix","matrix_set_min",i)([o,r,n])(n)},setMax:function(t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return a._call("matrix","matrix_set_max",i)([o,r,n])(n)},min:function(){var t=(new S).allocate();return a._call("matrix","matrix_min",i)([o,t])(t)},max:function(){var t=(new S).allocate();return a._call("matrix","matrix_max",i)([o,t])(t)},minMax:function(){var t=new e(o.rows(),o.cols()).allocate();return a._call("algebra","algebra_min_max",i)([o,t])(t)},img2col:function(t,r,n){var u=new e(o.rows(),o.cols()).allocate(),c=new A(3).allocate().set([t,r,n]);return a._call("algebra","algebra_img2col",i)([o,c,u])(u)},adamOptimize:function(t,r,n,o,u,c,l,f,s,y,p,b,v){var m=new e(t.rows(),t.cols()).allocate(),h=new e(r.rows(),r.cols()).allocate(),w=new e(u.rows(),u.cols()).allocate(),d=new e(c.rows(),c.cols()).allocate(),g=new e(l.rows(),l.cols()).allocate(),O=new e(f.rows(),f.cols()).allocate(),j=(new S).allocate().set([s]),P=(new S).allocate().set([y]),_=(new S).allocate().set([p]),k=(new S).allocate().set([b]),E=(new S).allocate().set([v]);return a._call("algebra","algebra_adam_optimize",i)([t,r,n,o,u,c,l,f,j,P,_,k,E],[m,h,w,d,g,O])({W:m,b:h,vW:w,vb:d,sW:g,sb:O})}})}},{key:"clone",value:function(){var t=new e(this.rows(),this.cols());return t.copyFrom(this),t}}],o=[{key:"runAdamOptimizer",value:function(t,r,n,o,i,u,a,c,l,f,s,y,p){return new e(1,1).calcSync(function(e){return e.adamOptimize(t,r,n,o,i,u,a,c,l,f,s,y,p)})}}],n&&N(r.prototype,n),o&&N(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(m);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q(n.key),n)}}function Q(t){var e=function(t){if("object"!=G(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}function X(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(X=function(){return!!t})()}function Y(t){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Y(t)}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}var et=function(t,e){return Math.round((t+223e-18)*Math.pow(10,e))/Math.pow(10,e)};const rt={Calc:f,CalcScalar:S,CalcMatrix2D:$,CalcColVector:R,CalcRowVector:A,CalcMatrix3D:function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Y(e),function(t,e){if(e&&("object"==G(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,X()?Reflect.construct(e,r||[],Y(t).constructor):e.apply(t,r))}(this,e,[t,r,n])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(e,t),r=e,(n=[{key:"isMatrix3D",value:function(){return!0}}])&&K(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(m),round:et},nt=require("fs");function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t){return function(t){if(Array.isArray(t))return ut(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ut(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ut(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lt(n.key),n)}}function ct(t,e,r){return(e=lt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lt(t){var e=function(t){if("object"!=ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:e+""}var ft=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,"dimensions",null),ct(this,"size",0),ct(this,"layers",[]),this.dimensions=e},(e=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"getLastLayer",value:function(){return this.layers[this.layers.length-1]}},{key:"forward",value:function(t){var e=t;return this.layers.forEach(function(t){e=t.forward(e)}),e}},{key:"backward",value:function(t,e,r){for(var n=t.cols(),o=r,i=this.layers.length-1;i>=0;i-=1){var u=this.layers[i],a=i===this.layers.length-1;o=u.getBackPropagation().propagate(t,n,e,u,o,a)}}},{key:"save",value:function(t){var e={dimensions:this.dimensions,layers:[]};this.layers.forEach(function(t){e.layers.push({type:t.getType(),size:t.getSize(),weights:{W:{data:it(t.W.get()),rows:t.W.rows(),cols:t.W.cols()},b:{data:it(t.b.get()),rows:t.b.rows(),cols:t.b.cols()}}})});var r=JSON.stringify(e);return new Promise(function(e,n){nt.writeFile(t,r,function(t){t&&(console.error(t),n()),e(r)})})}}])&&at(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function pt(t,e,r){return e&&yt(t.prototype,e),r&&yt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bt(t,e,r){return(e=vt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vt(t){var e=function(t){if("object"!=st(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==st(e)?e:e+""}var mt=pt(function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),bt(this,"layer",null),bt(this,"previousLayer",null),this.layer=e,this.previousLayer=r}),ht=function(t){return t.logistic="logistic",t.softmax="softmax",t.tanh="tanh",t.relu="relu",t.purelin="purelin",t}({});function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ot(n.key),n)}}function Ot(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}function jt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jt=function(){return!!t})()}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}function Pt(t,e){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pt(t,e)}var _t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=St(e),function(t,e){if(e&&("object"==wt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jt()?Reflect.construct(e,r||[],St(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pt(t,e)}(e,t),r=e,(n=[{key:"propagate",value:function(t,e,r,n,o,i){var u=o;i&&n.getType()!==ht.softmax&&u.replace(o.multiply(n.derivative(n.Z)));var a=null!==this.previousLayer?this.previousLayer.A:t,c=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,a=[],c=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw o}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return dt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(u.backwardPropagation(n.W,a,r,e),3),l=c[0],f=c[1],s=c[2];return n.gW.replace(l),n.gb.replace(f),s}}])&&gt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(mt);function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function Tt(t){var e=function(t){if("object"!=kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}var xt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"create",value:function(t,e){return new _t(e,t)}}],null&&Et(t.prototype,null),e&&Et(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wt(n.key),n)}}function Dt(t,e,r){return(e=Wt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wt(t){var e=function(t){if("object"!=Rt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}var Ct=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Dt(this,"dimensions",null),Dt(this,"lastLayer",null),Dt(this,"network",null),this.dimensions=e,this.network=new ft(this.dimensions)},e=[{key:"createLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new t;return"function"==typeof e&&e(r),null===this.lastLayer?this.firstLayerTransition(r):r.transition(this.lastLayer),r.configure(),r.setBackPropagation(xt.create(this.lastLayer,r)),this.network.addLayer(r),this.lastLayer=r,this}},{key:"getNetwork",value:function(){return this.network}}],e&&Bt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function At(t,e,r){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lt(t){var e=function(t){if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vt(n.key),n)}}function Zt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Zt=function(){return!!t})()}function Nt(){return Nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=qt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Nt.apply(null,arguments)}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}function It(t,e){return It=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},It(t,e)}function Vt(t){var e=function(t){if("object"!=Ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ft(e)?e:e+""}var Ut=function(t){function e(){var t,r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=qt(e),function(t,e){if(e&&("object"==Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zt()?Reflect.construct(e,r||[],qt(t).constructor):e.apply(t,r))}(this,e),r=t,(n=Vt(n="depth"))in r?Object.defineProperty(r,n,{value:1,enumerable:!0,configurable:!0,writable:!0}):r[n]=1,t.W=new $,t.b=new $,t.A=new $,t.Z=new $,t.gW=new $,t.gb=new $,t.vW=new $,t.vb=new $,t.sW=new $,t.sb=new $,t.dW=new $,t.db=new $,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&It(t,e)}(e,t),r=e,n=[{key:"configure",value:function(){this.W.resize(this.getHeight(),this.getWidth()),this.W.setRandom(Math.sqrt(6/this.getWidth())),this.b.resize(this.getHeight(),1).setZeros().add(1),this.gW.resize(this.getHeight(),this.getWidth()),this.gW.setZeros(),this.gb.resize(this.getHeight(),1),this.gb.setZeros(),this.sW.resize(this.getHeight(),this.getWidth()),this.sW.setZeros(),this.sb.resize(this.getHeight(),1),this.sb.setZeros(),this.vW.resize(this.getHeight(),this.getWidth()),this.vW.setZeros(),this.vb.resize(this.getHeight(),1),this.vb.setZeros(),this.dW.resize(this.getHeight(),this.getWidth()),this.dW.setZeros(),this.db.resize(this.getHeight(),1),this.db.setZeros()}},{key:"forward",value:function(t){return this.Z=t.forwardPropagation(this.W,this.b),this.A=this.activation(this.Z),this.A}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){var r,n,o;return t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth()),(r=e,n=this,"function"==typeof(o=Nt(qt(1&3?r.prototype:r),"transition",n))?function(t){return o.apply(n,t)}:o)([t]),this}},{key:"setSize",value:function(t){return this.setHeight(t),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}},{key:"penalty",value:function(){return this.W.pow(2).sum()}}],n&&Ht(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),At(this,"width",0),At(this,"height",0),At(this,"depth",0),At(this,"previousLayer",null),At(this,"backPropagation",null)},(e=[{key:"setBackPropagation",value:function(t){return this.backPropagation=t,this}},{key:"getBackPropagation",value:function(){return this.backPropagation}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"getDepth",value:function(){return this.depth}},{key:"transition",value:function(t){return this.previousLayer=t,this}}])&&Mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function $t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gt(n.key),n)}}function Gt(t){var e=function(t){if("object"!=Jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}function Kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Kt=function(){return!!t})()}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}var Yt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Qt(e),function(t,e){if(e&&("object"==Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kt()?Reflect.construct(e,r||[],Qt(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.softmax()}},{key:"getType",value:function(){return ht.softmax}},{key:"derivative",value:function(t){return t}}])&&$t(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ut);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,re(n.key),n)}}function re(t){var e=function(t){if("object"!=te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==te(e)?e:e+""}function ne(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ne=function(){return!!t})()}function oe(t){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oe(t)}function ie(t,e){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ie(t,e)}var ue=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=oe(e),function(t,e){if(e&&("object"==te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ne()?Reflect.construct(e,r||[],oe(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.logisticForwardPropagation()}},{key:"getType",value:function(){return ht.logistic}},{key:"derivative",value:function(t){return t.logisticBackwardPropagation()}}])&&ee(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ut);function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,le(n.key),n)}}function le(t){var e=function(t){if("object"!=ae(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ae(e)?e:e+""}function fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fe=function(){return!!t})()}function se(t){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},se(t)}function ye(t,e){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ye(t,e)}var pe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=se(e),function(t,e){if(e&&("object"==ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fe()?Reflect.construct(e,r||[],se(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ye(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.tanh()}},{key:"getType",value:function(){return ht.tanh}},{key:"derivative",value:function(t){return t.tanhDerivative()}}])&&ce(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ut);function be(t){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(t)}function ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function me(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(me=function(){return!!t})()}function he(t){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},he(t)}function we(t,e){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},we(t,e)}function de(t){var e=function(t){if("object"!=be(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==be(e)?e:e+""}var ge=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=he(e),function(t,e){if(e&&("object"==be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,me()?Reflect.construct(e,r||[],he(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=de(n="alpha"))in r?Object.defineProperty(r,n,{value:.01,enumerable:!0,configurable:!0,writable:!0}):r[n]=.01,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&we(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){var e=this;return t.calcSync(function(t){return t.leakyRelu(e.alpha)})}},{key:"getType",value:function(){return ht.relu}},{key:"derivative",value:function(t){var e=this;return t.calcSync(function(t){return t.leakyReluBackpropagation(e.alpha)})}}])&&ve(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Ut);function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function je(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Se(n.key),n)}}function Se(t){var e=function(t){if("object"!=Oe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Oe(e)?e:e+""}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Pe=function(){return!!t})()}function _e(t){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_e(t)}function ke(t,e){return ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ke(t,e)}var Ee=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=_e(e),function(t,e){if(e&&("object"==Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pe()?Reflect.construct(e,r||[],_e(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ke(t,e)}(e,t),r=e,o=[{key:"fromJSON",value:function(t){return new Promise(function(r,n){nt.readFile(t,function(t,o){if(t)n(t);else{var i=JSON.parse(o.toString()),u=new e(i.dimensions);i.layers.forEach(function(t){var e=null;"logistic"===t.type?e=ue:"softmax"===t.type?e=Yt:"relu"===t.type?e=ge:"tanh"===t.type&&(e=pe),u.createLayer(e,function(e){e.setSize(t.size)})});var a=u.getNetwork();a.getLayers().forEach(function(t,e){t.W=new $(i.layers[e].weights.W.rows,i.layers[e].weights.W.cols).allocate().set(i.layers[e].weights.W.data),t.b=new $(i.layers[e].weights.b.rows,i.layers[e].weights.b.cols).allocate().set(i.layers[e].weights.b.data)}),r(a)}})})}}],(n=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&je(r.prototype,n),o&&je(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ct);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Be(n.key),n)}}function Re(t,e,r){return(e=Be(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Be(t){var e=function(t){if("object"!=Te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Te(e)?e:e+""}var De=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Re(this,"batchSize",0),Re(this,"t",0),Re(this,"learningRate",0)},e=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}],e&&xe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fe(n.key),n)}}function ze(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ze=function(){return!!t})()}function Me(t){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Me(t)}function Ae(t,e){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ae(t,e)}function Le(t,e,r){return(e=Fe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fe(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}var He=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Le(t=function(t,e,r){return e=Me(e),function(t,e){if(e&&("object"==We(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ze()?Reflect.construct(e,r||[],Me(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"beta1",.9),Le(t,"beta2",.999),Le(t,"epsilon",1e-8),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ae(t,e)}(e,t),r=e,n=[{key:"optimize",value:function(t){var e=t.W,r=t.b,n=t.gW,o=t.gb,i=t.vW,u=t.vb,a=t.sW,c=t.sb,l=this.learningRate,f=this.beta1,s=this.beta2,y=this.epsilon,p=this.t,b=$.runAdamOptimizer(e,r,n,o,i,u,a,c,l,f,s,y,p);t.W.replace(b.W),t.b.replace(b.b),t.vW.replace(b.vW),t.vb.replace(b.vb),t.sW.replace(b.sW),t.sb.replace(b.sb)}}],n&&Ce(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(De);function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function Ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qe(n.key),n)}}function qe(t){var e=function(t){if("object"!=Ze(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ze(e)?e:e+""}function Ie(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ie=function(){return!!t})()}function Ve(t){return Ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ve(t)}function Ue(t,e){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ue(t,e)}var Je=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Ve(e),function(t,e){if(e&&("object"==Ze(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ie()?Reflect.construct(e,r||[],Ve(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.gradientDescent(t,this.learningRate)}},{key:"gradientDescent",value:function(t,e){t.W=t.W.subtract(t.gW.multiply(e)),t.b=t.b.subtract(t.gb.multiply(e))}}])&&Ne(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(De);function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function Ge(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ye(n.key),n)}}function Ke(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ke=function(){return!!t})()}function Qe(t){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qe(t)}function Xe(t,e){return Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xe(t,e)}function Ye(t){var e=function(t){if("object"!=$e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$e(e)?e:e+""}var tr=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=Qe(e),function(t,e){if(e&&("object"==$e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ke()?Reflect.construct(e,r||[],Qe(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=Ye(n="epsilon"))in r?Object.defineProperty(r,n,{value:1e-8,enumerable:!0,configurable:!0,writable:!0}):r[n]=1e-8,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xe(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.adagrad(t,this.learningRate)}},{key:"adagrad",value:function(t,e){t.dW=t.dW.add(t.gW.pow(2)),t.W=t.W.subtract(t.gW.multiply(e).divide(t.dW.add(this.epsilon).sqrt())),t.db=t.db.add(t.gb.pow(2)),t.b=t.b.subtract(t.gb.multiply(e).divide(t.db.add(this.epsilon).sqrt()))}}])&&Ge(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(De);function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ur(n.key),n)}}function nr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(nr=function(){return!!t})()}function or(t){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},or(t)}function ir(t,e){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ir(t,e)}function ur(t){var e=function(t){if("object"!=er(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==er(e)?e:e+""}var ar=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=or(e),function(t,e){if(e&&("object"==er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nr()?Reflect.construct(e,r||[],or(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=ur(n="beta"))in r?Object.defineProperty(r,n,{value:.9,enumerable:!0,configurable:!0,writable:!0}):r[n]=.9,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ir(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.momentum(t,this.learningRate)}},{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"momentum",value:function(t,e){t.vW=t.gW.multiply(this.beta).add(t.gW.multiply(1-this.beta)),t.vb=t.gb.multiply(this.beta).add(t.gb.multiply(1-this.beta)),t.W=t.W.subtract(t.vW.multiply(e)),t.b=t.b.subtract(t.vb.multiply(e))}}])&&rr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(De);function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}function lr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,br(n.key),n)}}function fr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fr=function(){return!!t})()}function sr(t){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sr(t)}function yr(t,e){return yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yr(t,e)}function pr(t,e,r){return(e=br(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function br(t){var e=function(t){if("object"!=cr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cr(e)?e:e+""}var vr=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return pr(t=function(t,e,r){return e=sr(e),function(t,e){if(e&&("object"==cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fr()?Reflect.construct(e,r||[],sr(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"alpha",.001),pr(t,"beta",.9),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yr(t,e)}(e,t),r=e,(n=[{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"setAlpha",value:function(t){return this.alpha=t,this}},{key:"optimize",value:function(t){this.rmsprop(t,this.learningRate,this.alpha,this.beta)}},{key:"rmsprop",value:function(t,e,r,n){t.sW=t.sW.multiply(n).add(t.gW.pow(2).multiply(1-n)),t.sb=t.sb.multiply(n).add(t.gb.pow(2).multiply(1-n)),t.W=t.W.subtract(t.gW.multiply(r).divide(t.sW.sqrt().add(1e-8))),t.b=t.b.subtract(t.gb.multiply(r).divide(t.sb.sqrt().add(1e-8)))}}])&&lr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(De);function mr(t){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mr(t)}function hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function wr(t,e,r){return(e=dr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dr(t){var e=function(t){if("object"!=mr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mr(e)?e:e+""}function gr(t){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gr(t)}function Or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_r(n.key),n)}}function jr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jr=function(){return!!t})()}function Sr(t){return Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sr(t)}function Pr(t,e){return Pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pr(t,e)}function _r(t){var e=function(t){if("object"!=gr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gr(e)?e:e+""}const kr={BatchTrainer:function(t){function e(t,r,n){var o,i,u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(t,e,r){return e=Sr(e),function(t,e){if(e&&("object"==gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jr()?Reflect.construct(e,r||[],Sr(t).constructor):e.apply(t,r))}(this,e,[t,r,n]),i=o,(u=_r(u="_batchSize"))in i?Object.defineProperty(i,u,{value:100,enumerable:!0,configurable:!0,writable:!0}):i[u]=100,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pr(t,e)}(e,t),r=e,n=[{key:"setBatchSize",value:function(t){return this._batchSize=t,this}},{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=0;this.optimizer.setBatchSize(this._batchSize),this.optimizer.setLearningRate(this.learningRate);for(var i=(new Date).getTime(),u=0;u<this.iterations;u+=1){for(var a=0;a<n;a+=this._batchSize){var c=t.getBatch(a,Math.min(n-a,this._batchSize)),l=e.getBatch(a,Math.min(n-a,this._batchSize)),f=this.network.forward(c),s=this.costFunction.derivative(l,f,this.network.getLastLayer());this.network.backward(c,this.regularization,s),this.optimizer.setT(++o),this.network.getLayers().forEach(function(t){r.optimizer.optimize(t)}),c.destroy(),l.destroy(),f.destroy(),s.destroy()}if(this.verbose&&(u+1)%this.verboseStep===0){var y=this.cost(this.network.forward(t.data),e.data),p=(new Date).getTime();console.log("Iteration: ".concat(u+1," | Cost: ").concat(et(y.cost,5)," | Accuracy: ").concat(et(y.accuracy,2),"% | Time: ").concat((p-i)/1e3," s.")),this.stepCallback({iteration:u}),i=(new Date).getTime()}}return this}}],n&&Or(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),wr(this,"regularization",1e-4),wr(this,"iterations",1e3),wr(this,"learningRate",.001),wr(this,"verbose",!0),wr(this,"verboseStep",1),wr(this,"stepCallback",function(t){}),this.network=e,this.optimizer=r,this.costFunction=n},(e=[{key:"setRegularization",value:function(t){return this.regularization=t,this}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}},{key:"setVerbose",value:function(t){return this.verbose=t,this}},{key:"setVerboseStep",value:function(t){return this.verboseStep=t,this}},{key:"setStepCallback",value:function(t){return this.stepCallback=t,this}},{key:"cost",value:function(t,e){var r=e.cols(),n=this.costFunction.loss(e,t).get()[0];if(this.regularization>0){var o=0;this.network.getLayers().forEach(function(t){var e=t.penalty();o+=e.get()[0],e.destroy()}),n+=this.regularization/(2*r)*o}for(var i=0,u=0;u<r;u+=1){var a=t.col(u),c=e.col(u),l=a.maxCoeff(),f=c.maxCoeff();l.get()[0]===f.get()[0]&&i++,a.destroy(),c.destroy(),l.destroy(),f.destroy()}return{cost:n,accuracy:i/r*100}}}])&&hr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}())};function Er(t){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(t)}function Tr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rr(n.key),n)}}function xr(t,e,r){return e&&Tr(t.prototype,e),r&&Tr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rr(t){var e=function(t){if("object"!=Er(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Er(e)?e:e+""}var Br=xr(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});function Dr(t){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dr(t)}function Wr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cr(n.key),n)}}function Cr(t){var e=function(t){if("object"!=Dr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dr(e)?e:e+""}function zr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zr=function(){return!!t})()}function Mr(t){return Mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mr(t)}function Ar(t,e){return Ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ar(t,e)}var Lr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Mr(e),function(t,e){if(e&&("object"==Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zr()?Reflect.construct(e,r||[],Mr(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ar(t,e)}(e,t),r=e,(n=[{key:"loss",value:function(t,e){var r=t.cols();return e.subtract(t).pow(2).sum().get()[0]/(2*r)}},{key:"derivative",value:function(t,e,r){return e.subtract(t)}}])&&Wr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Br);function Fr(t){return Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fr(t)}function Hr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ir(n.key),n)}}function Zr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Zr=function(){return!!t})()}function Nr(t){return Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nr(t)}function qr(t,e){return qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qr(t,e)}function Ir(t){var e=function(t){if("object"!=Fr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fr(e)?e:e+""}var Vr=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=Nr(e),function(t,e){if(e&&("object"==Fr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zr()?Reflect.construct(e,r||[],Nr(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=Ir(n="epsilon"))in r?Object.defineProperty(r,n,{value:1e-8,enumerable:!0,configurable:!0,writable:!0}):r[n]=1e-8,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qr(t,e)}(e,t),r=e,(n=[{key:"loss",value:function(t,e){return(new $).crossEntropyLoss(t,e,this.epsilon)}},{key:"derivative",value:function(t,e,r){return r.getType()===ht.softmax?e.subtract(t):(new $).crossEntropyDerivative(t,e,this.epsilon)}}])&&Hr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Br),Ur=r(928),Jr=r.n(Ur);function $r(t){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(t)}function Gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kr(n.key),n)}}function Kr(t){var e=function(t){if("object"!=$r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$r(e)?e:e+""}var Qr=function(){function t(){var e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,(r=Kr(r="data"))in e?Object.defineProperty(e,r,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[r]=null,this.data=n}return e=t,n=[{key:"fromMatrix",value:function(e){return new t(e)}}],(r=[{key:"exampleAt",value:function(t){return this.data.col(t)}},{key:"getNumberOfExamples",value:function(){return this.data.cols()}},{key:"getExampleSize",value:function(){return this.data.rows()}},{key:"getBatch",value:function(t,e){return this.data.block(0,t,this.getExampleSize(),e)}}])&&Gr(e.prototype,r),n&&Gr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function Xr(t){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(t)}function Yr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tn(n.key),n)}}function tn(t){var e=function(t){if("object"!=Xr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Xr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xr(e)?e:e+""}var en=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"fromSource",value:function(t){return new Promise(function(e){t.then(function(t){var r=t.parse();e(r)})})}}],null&&Yr(t.prototype,null),e&&Yr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function nn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,un(n.key),n)}}function on(t,e,r){return e&&nn(t.prototype,e),r&&nn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function un(t){var e=function(t){if("object"!=rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=rn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rn(e)?e:e+""}var an=on(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});function cn(t){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cn(t)}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fn(n.key),n)}}function fn(t){var e=function(t){if("object"!=cn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==cn(e)?e:e+""}var sn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"fromSource",value:function(t){return new Promise(function(e){t.then(function(t){var r=t.parse();e(new an(r))})})}}],null&&ln(t.prototype,null),e&&ln(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function yn(t){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yn(t)}function pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vn(n.key),n)}}function bn(t,e,r){return e&&pn(t.prototype,e),r&&pn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vn(t){var e=function(t){if("object"!=yn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yn(e)?e:e+""}var mn=bn(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});const hn=require("csvtojson");function wn(t){return wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wn(t)}function dn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sn(n.key),n)}}function gn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(gn=function(){return!!t})()}function On(t){return On=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},On(t)}function jn(t,e){return jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jn(t,e)}function Sn(t){var e=function(t){if("object"!=wn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wn(e)?e:e+""}var Pn=function(t){function e(t){var r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=On(e),function(t,e){if(e&&("object"==wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gn()?Reflect.construct(e,r||[],On(t).constructor):e.apply(t,r))}(this,e),n=r,(o=Sn(o="data"))in n?Object.defineProperty(n,o,{value:null,enumerable:!0,configurable:!0,writable:!0}):n[o]=null,r.data=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jn(t,e)}(e,t),r=e,o=[{key:"fromLocalFile",value:function(t){return new Promise(function(r){hn({noheader:!0,trim:!0,output:"csv"}).fromFile(t).then(function(t){r(new e(t))})})}}],(n=[{key:"parse",value:function(){for(var t,e=this.data.length,r=null===(t=this.data[0])||void 0===t?void 0:t.length,n=[],o=0;o<e;o+=1)this.data[o].forEach(function(t){n.push(Number(t))});return Qr.fromMatrix(new $(r,e).allocate().set(n))}}])&&dn(r.prototype,n),o&&dn(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(mn);function _n(t){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(t)}function kn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tn(n.key),n)}}function En(t,e,r){return e&&kn(t.prototype,e),r&&kn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tn(t){var e=function(t){if("object"!=_n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_n(e)?e:e+""}function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function Rn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cn(n.key),n)}}function Bn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Bn=function(){return!!t})()}function Dn(t){return Dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dn(t)}function Wn(t,e){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wn(t,e)}function Cn(t){var e=function(t){if("object"!=xn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xn(e)?e:e+""}var zn=function(t){function e(t){var r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=Dn(e),function(t,e){if(e&&("object"==xn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Bn()?Reflect.construct(e,r||[],Dn(t).constructor):e.apply(t,r))}(this,e),n=r,(o=Cn(o="data"))in n?Object.defineProperty(n,o,{value:"",enumerable:!0,configurable:!0,writable:!0}):n[o]="",r.data=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wn(t,e)}(e,t),r=e,o=[{key:"fromLocalFile",value:function(t){return new Promise(function(r,n){nt.readFile(t,function(t,o){t?n(t):r(new e(o.toString("utf-8")))})})}}],(n=[{key:"parse",value:function(){return this.data}}])&&Rn(r.prototype,n),o&&Rn(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(En(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));function Mn(t){return Mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mn(t)}function An(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fn(n.key),n)}}function Ln(t,e,r){return e&&An(t.prototype,e),r&&An(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fn(t){var e=function(t){if("object"!=Mn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Mn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mn(e)?e:e+""}var Hn=Ln(function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=Fn(n="dataset"))in r?Object.defineProperty(r,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):r[n]=null,this.dataset=e});function Zn(t){return Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zn(t)}function Nn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qn(n.key),n)}}function qn(t){var e=function(t){if("object"!=Zn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zn(e)?e:e+""}function In(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(In=function(){return!!t})()}function Vn(t){return Vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vn(t)}function Un(t,e){return Un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Un(t,e)}var Jn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Vn(e),function(t,e){if(e&&("object"==Zn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,In()?Reflect.construct(e,r||[],Vn(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Un(t,e)}(e,t),r=e,(n=[{key:"apply",value:function(t){return t.data.replace(t.data.minMax()),t}}])&&Nn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Hn);function $n(t){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$n(t)}function Gn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Yn(n.key),n)}}function Kn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Kn=function(){return!!t})()}function Qn(t){return Qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qn(t)}function Xn(t,e){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xn(t,e)}function Yn(t){var e=function(t){if("object"!=$n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$n(e)?e:e+""}var to=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,u=new Array(i),a=0;a<i;a++)u[a]=arguments[a];return t=function(t,e,r){return e=Qn(e),function(t,e){if(e&&("object"==$n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kn()?Reflect.construct(e,r||[],Qn(t).constructor):e.apply(t,r))}(this,e,[].concat(u)),r=t,o="mean",(n=Yn(n="modificationType"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xn(t,e)}(e,t),r=e,(n=[{key:"apply",value:function(t){for(var e=[],r=0,n=0,o=0,i=0;i<t.getNumberOfExamples();i+=1)for(var u=t.exampleAt(i),a=0;a<t.getExampleSize();a+=1)isNaN(u.data[a][0])||"number"!=typeof u.data[a][0]?e.push({row:a,col:u}):(n+=u.data[a][0],r++);return"mean"===this.modificationType&&(o=n/r),e.forEach(function(e){var r=e.row,n=e.col;t.data.data[r][n]=o}),t}},{key:"setModificationType",value:function(t){return this.modificationType=t,this}}])&&Gn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Hn);function eo(t){return eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eo(t)}function ro(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ro=function(){return!!t})()}function no(t){return no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},no(t)}function oo(t,e){return oo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oo(t,e)}var io=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=no(e),function(t,e){if(e&&("object"==eo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ro()?Reflect.construct(e,r||[],no(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oo(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Hn);function uo(t){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(t)}function ao(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ao=function(){return!!t})()}function co(t){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},co(t)}function lo(t,e){return lo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lo(t,e)}var fo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=co(e),function(t,e){if(e&&("object"==uo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ao()?Reflect.construct(e,r||[],co(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lo(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Hn),so={NetworkBuilder1D:Ee},yo={SoftmaxLayer:Yt,LogisticLayer:ue,ReluLayer:ge,TanhLayer:pe},po={OptimizerAdam:He,OptimizerGradientDescent:Je,OptimizerAdagrad:tr,OptimizerMomentum:ar,OptimizerRMSProp:vr},bo={MeanSquaredErrorCost:Lr,CrossEntropyCost:Vr};e().setModulePath(Jr().resolve(__dirname,"../"));var vo={DatasetBuilder:en,DatasetVocabularyBuilder:sn},mo={Dataset:Qr},ho={MinMaxScalingDatasetModifier:Jn,MissingDataDatasetModifier:to,ShuffleDatasetModifier:io,SplitDatasetModifier:fo},wo={DatasetBuilderSourceCSV:Pn,DatasetVocabularyBuilderSourceTextFile:zn};const go={NetworkBuilder:so,Layer:yo,Optimizer:po,Trainer:kr,Cost:bo,Math:rt,DatasetBuilder:vo,Dataset:mo,DatasetModifier:ho,DatasetBuilderSource:wo}})(),module.exports=n})();
//# sourceMappingURL=impulse-ml.js.map