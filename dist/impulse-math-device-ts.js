(()=>{var t={627:(t,e,r)=>{t=r.nmd(t);try{process.dlopen(t,r(928).join(__dirname,r.p,"8c0d713d94b87197578f9913475daeeb.node"))}catch(t){throw new Error("node-loader:\n"+t)}},928:t=>{"use strict";t.exports=require("path")}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.p="";var n={};(()=>{"use strict";r.r(n),r.d(n,{Cost:()=>qu,Dataset:()=>Xu,DatasetBuilder:()=>Vu,DatasetBuilderSource:()=>Gu,DatasetModifier:()=>$u,Layer:()=>Zu,Math:()=>Ju,Network:()=>Uu,NetworkBuilder:()=>Hu,Optimizer:()=>Nu,Trainer:()=>Iu,default:()=>Ku});var t=r(627),e=r.n(t),o=new(e().Device.CPU),i=function(){return o};function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function a(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"_result",null),a(this,"_params",null)}return e=t,r=[{key:"setResult",value:function(t){return this._result=t,this}},{key:"setParams",value:function(t){return this._params=t,this}},{key:"execSync",value:function(t,e){return this.exec(t,e)(this._params,this._result),this}},{key:"execAsync",value:function(t,e){var r=this;return new Promise(function(n){r.exec(t,e,!0)(r._params,r._result).then(function(){n(r)})})}},{key:"exec",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var n=i().loadModule(t).loadFunction(e);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n.execute((t||[]).map(function(t){return t.getMemory()}),(e||[]).map(function(t){return t.getMemory()}),r)}}catch(t){return console.error(t),function(){}}}}],n=[{key:"get",value:function(){return new t}}],r&&c(e.prototype,r),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function b(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}var h=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,"_dims",[]),b(this,"_allocated",!1),b(this,"_memory",null),this._dims=[e,r,n]},e=[{key:"dims",value:function(){return this._dims}},{key:"rows",value:function(){return this._dims[0]}},{key:"cols",value:function(){return this._dims[1]}},{key:"depth",value:function(){return this._dims[2]}},{key:"count",value:function(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){f=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this._dims,3);return t[0]*t[1]*t[2]}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._dims=[t,e,r],this.allocate(),this}},{key:"allocate",value:function(){var t=i();return this._memory=t.alloc(this.count()),this._memory.setWidth(this.rows()),this._memory.setHeight(this.cols()),this._memory.setDepth(this.depth()),this._allocated=!0,this}},{key:"set",value:function(t){return this._memory.set(new Float64Array(t)),this}},{key:"get",value:function(){return this._memory.get()}},{key:"isScalar",value:function(){return!1}},{key:"isRowVector",value:function(){return!1}},{key:"isColVector",value:function(){return!1}},{key:"isMatrix2D",value:function(){return!1}},{key:"isMatrix3D",value:function(){return!1}},{key:"setZeros",value:function(){return this.calcSync(function(t){t.setZeros()}),this}},{key:"setRandom",value:function(t){return this.calcSync(function(e){e.setRandom(t)}),this}},{key:"setMax",value:function(t){return this.calcSync(function(e){e.setMax(t)}),this}},{key:"setMin",value:function(t){return this.calcSync(function(e){e.setMin(t)}),this}},{key:"reluBackpropagation",value:function(t){return this.calcSync(function(t){t.reluBackpropagation()}),this}},{key:"pow",value:function(t){return this.calcSync(function(e){return e.pow(t)})}},{key:"sum",value:function(){return this.calcSync(function(t){return t.sum()})}},{key:"reluForwardPropagation",value:function(){return this.calcSync(function(t){t.reluForwardPropagation()}),this}},{key:"getCalcSandbox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this;return{sum:function(){var r=(new S).allocate();return e._call("algebra","algebra_sum",t)([e,r])(r)},setZeros:function(){return e._call("matrix","matrix_set_zeros",t)([e])(e)},setRandom:function(r){var n=(new S).allocate().set([r]);return e._call("matrix","matrix_set_random",t)([e,n])(e)}}}},{key:"_call",value:function(t,e,r){return function(n,o){var i=l.get().setResult(o).setParams(n);return function(n){return r?new Promise(function(r){i.execAsync(t,e).then(function(){r(n)})}):(i.execSync(t,e),n)}}}},{key:"calcSync",value:function(t){return t(this.getCalcSandbox(!1))}},{key:"calcAsync",value:function(t){var e=this;return new Promise(function(r,n){try{r(t(e.getCalcSandbox(!0)))}catch(t){n(t)}})}},{key:"getMemory",value:function(){return this._memory}},{key:Symbol.dispose,value:function(){this._memory.free()}},{key:"destroy",value:function(){this._memory.free(),this._dims=[0,0,0],this._allocated=!1}},{key:"copyFrom",value:function(t){if(!this._allocated){var e=i();this._memory=e.alloc(t.count()),this._allocated=!0}return this._memory.setWidth(t.rows()),this._memory.setHeight(t.cols()),this._memory.setDepth(t.depth()),this._memory.copyFrom(t.getMemory()),this._dims=t.dims(),this}}],e&&p(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function w(t){var e=function(t){if("object"!=m(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==m(e)?e:e+""}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(g=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}var S=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=O(e),function(t,e){if(e&&("object"==m(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}(this,e,[1])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),r=e,(n=[{key:"isScalar",value:function(){return!0}}])&&d(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=P(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(E=function(){return!!t})()}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}var x=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=T(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],T(t).constructor):e.apply(t,r))}(this,e,[1,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(e,t),r=e,o=[{key:"fromMemory",value:function(t,r){var n=new e(r);return n._memory=t,n._allocated=!0,n}}],(n=[{key:"isColVector",value:function(){return!0}}])&&_(r.prototype,n),o&&_(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(h);function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t){if("object"!=W(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==W(e)?e:e+""}function C(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(C=function(){return!!t})()}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z(t)}function A(t,e){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},A(t,e)}var M=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=z(e),function(t,e){if(e&&("object"==W(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,C()?Reflect.construct(e,r||[],z(t).constructor):e.apply(t,r))}(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A(t,e)}(e,t),r=e,(n=[{key:"isRowVector",value:function(){return!0}},{key:"transpose",value:function(){return x.fromMemory(this.getMemory().clone(),this.rows())}}])&&D(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach(function(e){Z(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Z(t,e,r){return(e=I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function I(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}function U(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(U=function(){return!!t})()}function q(){return q="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},q.apply(null,arguments)}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}function X(t,e){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X(t,e)}var $=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=V(e),function(t,e){if(e&&("object"==L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,U()?Reflect.construct(e,r||[],V(t).constructor):e.apply(t,r))}(this,e,[t,r])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(e,t),r=e,n=[{key:"isMatrix2D",value:function(){return!0}},{key:"row",value:function(t){var r=new e(1,this.cols()).allocate();return this._call("matrix","matrix_row",!1)([this,(new S).allocate().set(new Float64Array([t])),r])(r)}},{key:"col",value:function(t){var r=new e(this.rows(),1).allocate();return this._call("matrix","matrix_col",!1)([this,(new S).allocate().set(new Float64Array([t])),r])(r)}},{key:"maxCoeff",value:function(){return this.calcSync(function(t){return t.maxCoeff()})}},{key:"dot",value:function(t){return this.calcSync(function(e){return e.dot(t)})}},{key:"add",value:function(t){return this.calcSync(function(e){return e.add(t)})}},{key:"replicate",value:function(t,e){return this.calcSync(function(r){return r.replicate(t,e)})}},{key:"transpose",value:function(){return this.calcSync(function(t){return t.transpose()})}},{key:"logisticForwardPropagation",value:function(){return this.calcSync(function(t){return t.logisticForwardPropagation()})}},{key:"logisticBackwardPropagation",value:function(){return this.calcSync(function(t){return t.logisticBackwardPropagation()})}},{key:"pow",value:function(t){return this.calcSync(function(e){return e.pow(t)})}},{key:"log",value:function(){return this.calcSync(function(t){return t.log()})}},{key:"multiply",value:function(t){return this.calcSync(function(e){return e.multiply(t)})}},{key:"minusOne",value:function(){return this.calcSync(function(t){return t.minusOne()})}},{key:"conjugate",value:function(){return this.calcSync(function(t){return t.conjugate()})}},{key:"divide",value:function(t){return this.calcSync(function(e){return e.divide(t)})}},{key:"subtract",value:function(t){return this.calcSync(function(e){return e.subtract(t)})}},{key:"rowwiseSum",value:function(){return this.calcSync(function(t){return t.rowwiseSum()})}},{key:"softmax",value:function(){return this.calcSync(function(t){return t.softmax()})}},{key:"fraction",value:function(t){return this.calcSync(function(e){return e.fraction(t)})}},{key:"tanh",value:function(){return this.calcSync(function(t){return t.tanh()})}},{key:"tanhDerivative",value:function(){return this.calcSync(function(t){return t.tanhDerivative()})}},{key:"logMinusOne",value:function(){return this.calcSync(function(t){return t.logMinusOne()})}},{key:"sqrt",value:function(){return this.calcSync(function(t){return t.sqrt()})}},{key:"block",value:function(t,e,r,n){return this.calcSync(function(o){return o.block(t,e,r,n)})}},{key:"softmaxDerivative",value:function(){return this.calcSync(function(t){return t.softmaxDerivative()})}},{key:"min",value:function(){return this.calcSync(function(t){return t.min()})}},{key:"max",value:function(){return this.calcSync(function(t){return t.max()})}},{key:"minMax",value:function(){return this.calcSync(function(t){return t.minMax()})}},{key:"getCalcSandbox",value:function(){var t,r,n,o=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=(t=e,r=this,"function"==typeof(n=q(V(1&3?t.prototype:t),"getCalcSandbox",r))?function(t){return n.apply(r,t)}:n)([i]),c=this;return H(H({},u),{},{block:function(t,r,n,o){var u=new e(o-n,r).allocate(),a=(new S).allocate().set([t]),f=(new S).allocate().set([r]),l=(new S).allocate().set([n]),s=(new S).allocate().set([o]);return c._call("matrix","matrix_block",i)([c,a,f,l,s,u])(u)},pow:function(t){var r=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_pow",i)([c,(new S).allocate().set([t]),r])(r)},fraction:function(t){var r=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_fraction",i)([c,(new S).allocate().set([t]),r])(r)},softmax:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_softmax",i)([c,t])(t)},sqrt:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_sqrt",i)([c,t])(t)},tanh:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_tanh",i)([c,t])(t)},tanhDerivative:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_tanh_derivative",i)([c,t])(t)},softmaxDerivative:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_softmax_derivative",i)([c,t])(t)},rowwiseSum:function(){var t=new e(o.rows(),1).allocate();return c._call("algebra","algebra_rowwise_sum",i)([c,t])(t)},multiply:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_multiply_number",i)([c,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_multiply",i)([c,t,u])(u)},log:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_log",i)([c,t])(t)},divide:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_divide_number",i)([c,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_divide_matrix",i)([c,t,u])(u)},dot:function(t){var r=new e(o.rows(),t.cols()).allocate();return c._call("algebra","algebra_dot",i)([c,t,r])(r)},add:function(t){if("number"==typeof t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_add_number",i)([c,r,n])(n)}var u=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_add_matrix",i)([c,t,u])(u)},subtract:function(t){var r=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_subtract",i)([c,t,r])(r)},transpose:function(){var t=new e(o.cols(),o.rows()).allocate();return c._call("matrix","matrix_transpose",i)([c,t])(t)},logMinusOne:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_log_minus_one",i)([c,t])(t)},minusOne:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_minus_one",i)([c,t])(t)},replicate:function(t,r){var n=new e(o.rows()*t,o.cols()*r).allocate(),u=(new S).allocate().set([t]),a=(new S).allocate().set([r]);return c._call("algebra","algebra_replicate_matrix",i)([c,u,a,n])(n)},logisticForwardPropagation:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_logistic_forward_propagation",i)([c,t])(t)},conjugate:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_conjugate",i)([c,t])(t)},logisticBackwardPropagation:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_logistic_backward_propagation",i)([c,t])(t)},reluBackpropagation:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_reluBackpropagation",i)([c,t])(t)},maxCoeff:function(){var t=(new S).allocate();return c._call("algebra","algebra_max_coeff",i)([c,t])(t)},setMin:function(t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return c._call("matrix","matrix_set_min",i)([c,r,n])(n)},setMax:function(t){var r=(new S).allocate().set([t]),n=new e(o.rows(),o.cols()).allocate();return c._call("matrix","matrix_set_max",i)([c,r,n])(n)},min:function(){var t=(new S).allocate();return c._call("matrix","matrix_min",i)([c,t])(t)},max:function(){var t=(new S).allocate();return c._call("matrix","matrix_max",i)([c,t])(t)},minMax:function(){var t=new e(o.rows(),o.cols()).allocate();return c._call("algebra","algebra_min_max",i)([c,t])(t)},img2col:function(t,r,n){var u=new e(o.rows(),o.cols()).allocate(),a=new M(3).allocate().set([t,r,n]);return c._call("algebra","algebra_img2col",i)([c,a,u])(u)}})}},{key:"clone",value:function(){var t=new e(this.rows(),this.cols());return t.copyFrom(this),t}}],n&&N(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,K(n.key),n)}}function K(t){var e=function(t){if("object"!=G(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Y=function(){return!!t})()}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}function tt(t,e){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tt(t,e)}var et=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Q(e),function(t,e){if(e&&("object"==G(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(e,r||[],Q(t).constructor):e.apply(t,r))}(this,e,[t,r,n])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tt(t,e)}(e,t),r=e,(n=[{key:"isMatrix3D",value:function(){return!0}}])&&J(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(h);const rt=require("fs");function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ut(n.key),n)}}function it(t,e,r){return(e=ut(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ut(t){var e=function(t){if("object"!=nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nt(e)?e:e+""}var ct=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),it(this,"dimensions",null),it(this,"size",0),it(this,"layers",[]),this.dimensions=e},(e=[{key:"addLayer",value:function(t){return this.size++,this.layers.push(t),this}},{key:"getLayers",value:function(){return this.layers}},{key:"getLastLayer",value:function(){return this.layers[this.layers.length-1]}},{key:"forward",value:function(t){var e=t;return this.layers.forEach(function(t){e=t.forward(e)}),e}},{key:"forwardAsync",value:function(t){var e=this;return new Promise(function(r){var n=t.clone(),o=0,i=function(){return e.layers[o].forwardAsync(n).then(function(t){n.destroy(),n=t,o<e.layers.length-1?(o++,i()):r(n)})};i()})}},{key:"backward",value:function(t,e,r){for(var n=t.cols(),o=r,i=this.layers.length-1;i>=0;i-=1){var u=this.layers[i];o=u.getBackPropagation().propagate(t,n,e,u,o)}}},{key:"save",value:function(t){var e={dimensions:this.dimensions,layers:[]};this.layers.forEach(function(t){e.layers.push({type:t.getType(),size:t.getSize(),weights:{W:t.W.get(),b:t.b.get()}})});var r=JSON.stringify(e);return new Promise(function(e,n){rt.writeFile(t,r,function(t){t&&(console.error(t),n()),e(r)})})}}])&&ot(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function lt(t,e,r){return e&&ft(t.prototype,e),r&&ft(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function st(t){var e=function(t){if("object"!=at(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:e+""}var yt=lt(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ht(n.key),n)}}function vt(t,e,r){return e&&bt(t.prototype,e),r&&bt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ht(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}var mt=vt(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),dt=function(t){return t.logistic="logistic",t.softmax="softmax",t.tanh="tanh",t.relu="relu",t.softplus="softplus",t.conv="conv",t.maxpool="maxpool",t.fullyconnected="fullyconnected",t.purelin="purelin",t.rnnlayer="rnnlayer",t.lstm="lstm",t}({});function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function Ot(t,e,r){return e&&gt(t.prototype,e),r&&gt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function jt(t,e,r){return(e=St(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function St(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}var Pt=Ot(function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),jt(this,"layer",null),jt(this,"previousLayer",null),this.layer=e,this.previousLayer=r}),_t=function(t,e){return Math.round((t+223e-18)*Math.pow(10,e))/Math.pow(10,e)};function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function Tt(t){var e=function(t){if("object"!=kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}function Rt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Rt=function(){return!!t})()}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}function Wt(t,e){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wt(t,e)}var Dt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=xt(e),function(t,e){if(e&&("object"==kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Rt()?Reflect.construct(e,r||[],xt(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wt(t,e)}(e,t),r=e,(n=[{key:"propagate",value:function(t,e,r,n,o){var i=null!==this.previousLayer?this.previousLayer.A:t,u=o.dot(i.transpose().conjugate());if(this.layer.gW=u.divide(e).add(n.W.multiply(r/e)),this.layer.gb=o.rowwiseSum().divide(e),null!==this.previousLayer){var c=this.layer.W.transpose().dot(o);if(c.rows()!==i.rows()||c.cols()!==i.cols())throw new Error("Dimension error 1. (".concat(c.rows(),", ").concat(c.cols(),") | (").concat(i.rows(),", ").concat(i.cols(),")"));if(this.layer.gW.rows()!==this.layer.W.rows()||this.layer.gW.cols()!==this.layer.W.cols())throw new Error("Dimension error 2. (".concat(this.layer.gW.rows(),", ").concat(this.layer.gW.cols(),") | (").concat(this.layer.W.rows(),", ").concat(this.layer.W.cols(),")"));if(this.layer.gb.rows()!==this.layer.b.rows()||this.layer.gb.cols()!==this.layer.b.cols())throw new Error("Dimension error 3. (".concat(this.layer.gb.rows(),", ").concat(this.layer.gb.cols(),") | (").concat(this.layer.b.rows(),", ").concat(this.layer.b.cols(),")"));return c.multiply(this.layer.previousLayer.derivative(this.layer.previousLayer.A))}return new $}}])&&Et(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pt);function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function Ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function zt(t){var e=function(t){if("object"!=Bt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bt(e)?e:e+""}function At(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(At=function(){return!!t})()}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}var Ft=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Mt(e),function(t,e){if(e&&("object"==Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,At()?Reflect.construct(e,r||[],Mt(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}(e,t),r=e,(n=[{key:"propagate",value:function(t,e,r,n,o){return o}}])&&Ct(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pt);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function It(t){var e=function(t){if("object"!=Ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ht(e)?e:e+""}function Ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ut=function(){return!!t})()}function qt(t){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qt(t)}function Vt(t,e){return Vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vt(t,e)}var Xt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=qt(e),function(t,e){if(e&&("object"==Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ut()?Reflect.construct(e,r||[],qt(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vt(t,e)}(e,t),r=e,(n=[{key:"propagate",value:function(t,e,r,n,o){for(var i=n.cache,u=i.switches,c=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){f=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Zt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.inputShape,4),a=c[0],f=c[1],l=c[2],s=c[3],y=new $(a*f*l,s).setZeros(),p=y.get(),b=o.get(),v=0,h=o.get().length,m=0;m<h;m++)p[u[v++]]+=b[m];return y.set(p),y.reshape(a*f*l,s)}}])&&Nt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pt);function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Gt=function(){return!!t})()}function Jt(t){return Jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jt(t)}function Kt(t,e){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kt(t,e)}var Yt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Jt(e),function(t,e){if(e&&("object"==$t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Gt()?Reflect.construct(e,r||[],Jt(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kt(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(Pt);function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ee(n.key),n)}}function ee(t){var e=function(t){if("object"!=Qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qt(e)?e:e+""}function re(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(re=function(){return!!t})()}function ne(t){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ne(t)}function oe(t,e){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oe(t,e)}var ie=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ne(e),function(t,e){if(e&&("object"==Qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,re()?Reflect.construct(e,r||[],ne(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oe(t,e)}(e,t),r=e,n=[{key:"propagate",value:function(t,e,r,n,o){for(var i=n,u=i.cache,c=u.A,a=u.X,f=a.length,l=new $(i.getWidth(),1).setZeros(),s=f-1;s>=0;s--){var y=o.col(s);i.dWya=i.dWya.add(y.dot(c[s+1].transpose())),i.dby=i.dby.add(y);var p=i.Wya.transpose().dot(y).add(l).multiply(i.derivative(c[s+1]));i.dWax=i.dWax.add(p.dot(a[s].transpose())),i.dWaa=i.dWaa.add(p.dot(c[s].transpose())),i.dba=i.dba.add(p),l=i.Waa.transpose().dot(p)}for(var b=0,v=[i.dWax,i.dWaa,i.dWya,i.dba,i.dby];b<v.length;b++)v[b].clip(-5,5);return i.dWax=i.dWax.add(i.Wax.multiply(r)),i.dWaa=i.dWaa.add(i.Waa.multiply(r)),i.dWya=i.dWya.add(i.Wya.multiply(r)),new $}}],n&&te(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pt);function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ae(n.key),n)}}function ae(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}function fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(fe=function(){return!!t})()}function le(t){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},le(t)}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}var ye=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=le(e),function(t,e){if(e&&("object"==ue(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fe()?Reflect.construct(e,r||[],le(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(e,t),r=e,n=[{key:"propagate",value:function(t,e,r,n,o){for(var i=n,u=i.cache,c=u.A,a=u.C,f=u.X,l=u.F,s=u.I,y=u.G,p=u.O,b=f.length,v=i.getWidth(),h=new $(v,1).setZeros(),m=new $(v,1).setZeros(),d=b-1;d>=0;d--){var w=o.col(d).add(h),g=w.multiply(a[d+1].tanh()).multiply(p[d]).multiply(p[d].minusOne().multiply(-1)),O=w.multiply(p[d]).multiply(i.derivative(a[d+1])).add(m),j=O.multiply(a[d]).multiply(l[d]).multiply(l[d].minusOne().multiply(-1)),S=O.multiply(y[d]).multiply(s[d]).multiply(s[d].minusOne().multiply(-1)),P=O.multiply(s[d]).multiply(i.derivative(y[d])),_=$.vstack([j,S,P,g]);i.dW=i.dW.add(_.dot(f[d].transpose())),i.dU=i.dU.add(_.dot(c[d].transpose())),i.db=i.db.add(_),h=i.U.transpose().dot(_),m=O.multiply(l[d])}for(var k=0,E=[i.dW,i.dU,i.db];k<E.length;k++)E[k].clip(-5,5);return i.dW=i.dW.add(i.W.multiply(r)),i.dU=i.dU.add(i.U.multiply(r)),new $}}],n&&ce(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pt);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ve(n.key),n)}}function ve(t){var e=function(t){if("object"!=pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pe(e)?e:e+""}var he=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"create",value:function(t,e){if(e.getType()===dt.rnnlayer)return new ie(e,t);if(e.getType()===dt.lstm)return new ye(e,t);if(e.getType()===dt.maxpool)return new Xt(e,t);if(e.getType()===dt.conv)return new Yt(e,t);if(t){if(t.is1D()||t.getType()==dt.fullyconnected)return new Dt(e,t)}else{if(e.is1D())return new Dt(e,t);if(e.is3D())return new Ft(e,t)}return null}}],null&&be(t.prototype,null),e&&be(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function me(t){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(t)}function de(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ge(n.key),n)}}function we(t,e,r){return(e=ge(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ge(t){var e=function(t){if("object"!=me(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==me(e)?e:e+""}var Oe=function(){return t=function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DNN";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),we(this,"dimensions",null),we(this,"lastLayer",null),we(this,"network",null),this.dimensions=e,"DNN"===r?this.network=new ct(this.dimensions):"RNN"===r?this.network=new yt(this.dimensions):"LSTM"===r&&(this.network=new mt(this.dimensions))},e=[{key:"createLayer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new t;return"function"==typeof e&&e(r),null===this.lastLayer?this.firstLayerTransition(r):r.transition(this.lastLayer),r.configure(),r.setBackPropagation(he.create(this.lastLayer,r)),this.network.addLayer(r),this.lastLayer=r,this}},{key:"getNetwork",value:function(){return this.network}}],e&&de(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function je(t){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(t)}function Se(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_e(n.key),n)}}function Pe(t,e,r){return(e=_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _e(t){var e=function(t){if("object"!=je(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==je(e)?e:e+""}var ke=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Pe(this,"width",0),Pe(this,"height",0),Pe(this,"depth",0),Pe(this,"previousLayer",null),Pe(this,"backPropagation",null)},(e=[{key:"setBackPropagation",value:function(t){return this.backPropagation=t,this}},{key:"getBackPropagation",value:function(){return this.backPropagation}},{key:"setWidth",value:function(t){return this.width=t,this}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){return this.height=t,this}},{key:"getHeight",value:function(){return this.height}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"getDepth",value:function(){return this.depth}},{key:"transition",value:function(t){return this.previousLayer=t,this}}])&&Se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ee(t){return Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ee(t)}function Te(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ce(n.key),n)}}function xe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xe=function(){return!!t})()}function We(){return We="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=De(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},We.apply(null,arguments)}function De(t){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},De(t)}function Be(t,e){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Be(t,e)}function Ce(t){var e=function(t){if("object"!=Ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ee(e)?e:e+""}var ze=function(t){function e(){var t,r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=De(e),function(t,e){if(e&&("object"==Ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xe()?Reflect.construct(e,r||[],De(t).constructor):e.apply(t,r))}(this,e),r=t,(n=Ce(n="depth"))in r?Object.defineProperty(r,n,{value:1,enumerable:!0,configurable:!0,writable:!0}):r[n]=1,t.W=new $,t.b=new $,t.A=new $,t.Z=new $,t.gW=new $,t.gb=new $,t.vW=new $,t.vb=new $,t.sW=new $,t.sb=new $,t.dW=new $,t.db=new $,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Be(t,e)}(e,t),r=e,n=[{key:"configure",value:function(){this.W.resize(this.getHeight(),this.getWidth()),this.W.setRandom(this.previousLayer?this.previousLayer.getHeight():this.getHeight()),this.b.resize(this.getHeight(),1),this.b.setRandom(this.previousLayer?this.previousLayer.getHeight():this.getHeight()),this.gW.resize(this.getHeight(),this.getWidth()),this.gW.setZeros(),this.gb.resize(this.getHeight(),1),this.gb.setZeros(),this.sW.resize(this.getHeight(),this.getWidth()),this.sW.setZeros(),this.sb.resize(this.getHeight(),1),this.sb.setZeros(),this.vW.resize(this.getHeight(),this.getWidth()),this.vW.setZeros(),this.vb.resize(this.getHeight(),1),this.vb.setZeros(),this.dW.resize(this.getHeight(),this.getWidth()),this.dW.setZeros(),this.db.resize(this.getHeight(),1),this.db.setZeros()}},{key:"forward",value:function(t){return this.Z=this.W.dot(t).add(this.b.replicate(1,t.cols())),this.A=this.activation(this.Z),this.A}},{key:"forwardAsync",value:function(t){var e=this;return new Promise(function(r){Promise.all([e.W.calcAsync(function(e){return e.dot(t)}),e.b.calcAsync(function(e){return e.replicate(1,t.cols())})]).then(function(t){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){f=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Te(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Te(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),o=n[0],i=n[1];o.calcAsync(function(t){return t.add(i)}).then(function(t){e.Z.copyFrom(t),e.activationAsync(e.Z).then(function(n){e.A.copyFrom(n),o.destroy(),i.destroy(),t.destroy(),n.destroy(),r(e.A)})})})})}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){var r,n,o;return t.is1D()?this.setWidth(t.getSize()):t.is3D()&&this.setWidth(t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth()),(r=e,n=this,"function"==typeof(o=We(De(1&3?r.prototype:r),"transition",n))?function(t){return o.apply(n,t)}:o)([t]),this}},{key:"setSize",value:function(t){return this.setHeight(t),this}},{key:"getSize",value:function(){return this.height}},{key:"getOutputWidth",value:function(){return this.width}},{key:"getOutputHeight",value:function(){return this.height}},{key:"getOutputDepth",value:function(){return 1}},{key:"penalty",value:function(){return this.W.pow(2).sum()}}],n&&Re(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ke);function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Le(n.key),n)}}function Le(t){var e=function(t){if("object"!=Ae(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ae(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ae(e)?e:e+""}function Fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Fe=function(){return!!t})()}function He(t){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},He(t)}function Ze(t,e){return Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ze(t,e)}var Ne=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=He(e),function(t,e){if(e&&("object"==Ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Fe()?Reflect.construct(e,r||[],He(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ze(t,e)}(e,t),r=e,(n=[{key:"activationAsync",value:function(t){throw new Error("Method not implemented.")}},{key:"activation",value:function(t){return t.softmax()}},{key:"getType",value:function(){return dt.softmax}},{key:"derivative",value:function(t){return t.softmaxDerivative()}}])&&Me(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function Ue(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qe(n.key),n)}}function qe(t){var e=function(t){if("object"!=Ie(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ie(e)?e:e+""}function Ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ve=function(){return!!t})()}function Xe(t){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xe(t)}function $e(t,e){return $e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$e(t,e)}var Ge=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Xe(e),function(t,e){if(e&&("object"==Ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ve()?Reflect.construct(e,r||[],Xe(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$e(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.logisticForwardPropagation()}},{key:"activationAsync",value:function(t){return new Promise(function(e){t.calcAsync(function(t){t.logisticForwardPropagation().then(function(t){e(t)})})})}},{key:"getType",value:function(){return dt.logistic}},{key:"derivative",value:function(t){return t.logisticBackwardPropagation()}}])&&Ue(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function Je(t){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Je(t)}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ye(n.key),n)}}function Ye(t){var e=function(t){if("object"!=Je(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Je(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Je(e)?e:e+""}function Qe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Qe=function(){return!!t})()}function tr(t){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tr(t)}function er(t,e){return er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},er(t,e)}var rr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=tr(e),function(t,e){if(e&&("object"==Je(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qe()?Reflect.construct(e,r||[],tr(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&er(t,e)}(e,t),r=e,(n=[{key:"activationAsync",value:function(t){throw new Error("Method not implemented.")}},{key:"activation",value:function(t){return t.tanh()}},{key:"getType",value:function(){return dt.tanh}},{key:"derivative",value:function(t){return t.tanhDerivative()}}])&&Ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function nr(t){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nr(t)}function or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ir(n.key),n)}}function ir(t){var e=function(t){if("object"!=nr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nr(e)?e:e+""}function ur(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ur=function(){return!!t})()}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cr(t)}function ar(t,e){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ar(t,e)}var fr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=cr(e),function(t,e){if(e&&("object"==nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ur()?Reflect.construct(e,r||[],cr(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.setMin(0)}},{key:"activationAsync",value:function(t){return new Promise(function(e){t.calcAsync(function(t){t.setMin(0).then(function(t){e(t)})})})}},{key:"getType",value:function(){return dt.relu}},{key:"derivative",value:function(t){return t.reluBackpropagation()}}])&&or(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function lr(t){return lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lr(t)}function sr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yr(n.key),n)}}function yr(t){var e=function(t){if("object"!=lr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lr(e)?e:e+""}function pr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pr=function(){return!!t})()}function br(t){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},br(t)}function vr(t,e){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vr(t,e)}var hr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=br(e),function(t,e){if(e&&("object"==lr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,pr()?Reflect.construct(e,r||[],br(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vr(t,e)}(e,t),r=e,(n=[{key:"activation",value:function(t){return t.exp().add(1).log()}},{key:"getType",value:function(){return dt.softplus}},{key:"derivative",value:function(t){return t.multiply(-1).exp().add(1).fraction(1)}}])&&sr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function mr(t){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mr(t)}function dr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wr(n.key),n)}}function wr(t){var e=function(t){if("object"!=mr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mr(e)?e:e+""}function gr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(gr=function(){return!!t})()}function Or(){return Or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=jr(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Or.apply(null,arguments)}function jr(t){return jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jr(t)}function Sr(t,e){return Sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sr(t,e)}var Pr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,r){return e=jr(e),function(t,e){if(e&&("object"==mr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gr()?Reflect.construct(e,r||[],jr(t).constructor):e.apply(t,r))}(this,e)).W=new $,t.b=new $,t.A=new $,t.Z=new $,t.gW=new $,t.gb=new $,t.vW=new $,t.vb=new $,t.sW=new $,t.sb=new $,t.dW=new $,t.db=new $,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sr(t,e)}(e,t),r=e,n=[{key:"configure",value:function(){}},{key:"is1D",value:function(){return!1}},{key:"is3D",value:function(){return!0}},{key:"transition",value:function(t){var r,n,o;return t.is3D()&&this.setSize([t.getOutputWidth(),t.getOutputHeight(),t.getOutputDepth()]),(r=e,n=this,"function"==typeof(o=Or(jr(1&3?r.prototype:r),"transition",n))?function(t){return o.apply(n,t)}:o)([t]),this}},{key:"setSize",value:function(t){return this.setWidth(t[0]),this.setHeight(t[1]),this.setDepth(t[2]),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight(),this.getDepth()]}},{key:"penalty",value:function(){return this.W.pow(2).sum()}}],n&&dr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ke);function _r(t){return _r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(t)}function kr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wr(n.key),n)}}function Er(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Er=function(){return!!t})()}function Tr(t){return Tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(t)}function Rr(t,e){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Rr(t,e)}function xr(t,e,r){return(e=Wr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wr(t){var e=function(t){if("object"!=_r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=_r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_r(e)?e:e+""}var Dr=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return xr(t=function(t,e,r){return e=Tr(e),function(t,e){if(e&&("object"==_r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Er()?Reflect.construct(e,r||[],Tr(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"numFilters",8),xr(t,"filterSize",3),xr(t,"padding",1),xr(t,"stride",1),xr(t,"cache",{}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rr(t,e)}(e,t),r=e,(n=[{key:"penalty",value:function(){return this.W.pow(2).sum().get()[0]}},{key:"configure",value:function(){var t=this.getDepth(),e=this.filterSize*this.filterSize*t;this.W=new $(this.numFilters,e).setRandom(e),this.b=new $(this.numFilters,1).setZeros(),this.gW=new $(this.numFilters,e).setZeros(),this.gb=new $(this.numFilters,1).setZeros()}},{key:"getOutputHeight",value:function(){return Math.floor((this.getHeight()-this.filterSize+2*this.padding)/this.stride+1)}},{key:"getOutputWidth",value:function(){return Math.floor((this.getWidth()-this.filterSize+2*this.padding)/this.stride+1)}},{key:"getOutputDepth",value:function(){return this.numFilters}},{key:"im2col",value:function(t,e){var r=this,n=[this.getHeight(),this.getWidth(),this.getDepth()][2],o=this.getOutputHeight(),i=this.getOutputWidth(),u=this.filterSize*this.filterSize;return new $(u*n,o*i*e).allocate().calcSync(function(t){return t.img2col(r.filterSize,r.stride,r.padding)})}},{key:"forward",value:function(t){var e=t.cols(),r=this.getOutputHeight(),n=this.getOutputWidth(),o=this.im2col(t,e);this.cache={inputCols:o,inputShape:[this.getHeight(),this.getWidth(),this.getDepth()]};var i=this.W.dot(o).add(this.b).reshape(this.numFilters,r*n*e);return this.Z=i,this.A=this.activation(this.Z),this.A}},{key:"activation",value:function(t){return t.relu()}},{key:"derivative",value:function(t){return t.reluDerivative(this.A)}},{key:"getType",value:function(){return dt.conv}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"setNumFilters",value:function(t){return this.numFilters=t,this}},{key:"setPadding",value:function(t){return this.padding=t,this}},{key:"setStride",value:function(t){return this.stride=t,this}}])&&kr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pr);function Br(t){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Br(t)}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lr(n.key),n)}}function zr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zr=function(){return!!t})()}function Ar(t){return Ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ar(t)}function Mr(t,e){return Mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mr(t,e)}function Lr(t){var e=function(t){if("object"!=Br(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Br(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Br(e)?e:e+""}var Fr=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=function(t,e,r){return e=Ar(e),function(t,e){if(e&&("object"==Br(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zr()?Reflect.construct(e,r||[],Ar(t).constructor):e.apply(t,r))}(this,e,[].concat(u)),r=t,o={},(n=Lr(n="cache"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mr(t,e)}(e,t),r=e,(n=[{key:"penalty",value:function(){return this.W.pow(2).sum().get()[0]}},{key:"configure",value:function(t,e){this.width=e,this.height=t,this.W=new $(e,t).setRandom(t),this.b=new $(e,1).setZeros(),this.gW=new $(e,t).setZeros(),this.gb=new $(e,1).setZeros()}},{key:"transition",value:function(t){var e;return this.previousLayer=t,e=t.is3D()?t.getOutputWidth()*t.getOutputHeight()*t.getOutputDepth():t.getOutputWidth(),this.configure(e,this.getWidth()),this}},{key:"forward",value:function(t){var e=t.cols(),r=t;if(this.previousLayer&&this.previousLayer.is3D()){var n=this.W.cols();r=t.reshape(n,e)}return this.cache={input:r},this.Z=this.W.dot(r).add(this.b),this.A=this.Z,this.A}},{key:"activation",value:function(t){return t}},{key:"derivative",value:function(t){return t}},{key:"getType",value:function(){return dt.fullyconnected}},{key:"setSize",value:function(t){return this.width=t,this}}])&&Cr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ze);function Hr(t){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hr(t)}function Zr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vr(n.key),n)}}function Nr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Nr=function(){return!!t})()}function Ir(t){return Ir=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ir(t)}function Ur(t,e){return Ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ur(t,e)}function qr(t,e,r){return(e=Vr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vr(t){var e=function(t){if("object"!=Hr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Hr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Hr(e)?e:e+""}var Xr=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return qr(t=function(t,e,r){return e=Ir(e),function(t,e){if(e&&("object"==Hr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Nr()?Reflect.construct(e,r||[],Ir(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"filterSize",2),qr(t,"stride",2),qr(t,"cache",{}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ur(t,e)}(e,t),r=e,(n=[{key:"penalty",value:function(){return 0}},{key:"configure",value:function(){}},{key:"activation",value:function(t){return t}},{key:"derivative",value:function(t){return t}},{key:"getOutputHeight",value:function(){return Math.floor((this.getHeight()-this.filterSize)/this.stride+1)}},{key:"getOutputWidth",value:function(){return Math.floor((this.getWidth()-this.filterSize)/this.stride+1)}},{key:"getOutputDepth",value:function(){return this.getDepth()}},{key:"forward",value:function(t){for(var e=t.cols(),r=[this.getHeight(),this.getWidth(),this.getDepth()],n=r[0],o=r[1],i=r[2],u=this.getOutputHeight(),c=this.getOutputWidth(),a=new $(u*c*i,e).allocate().setZeros(),f=[],l=t.get(),s=a.get(),y=0;y<e;y++)for(var p=y*n*o*i,b=0;b<i;b++)for(var v=b*n*o,h=0;h<u;h++)for(var m=0;m<c;m++){for(var d=h*this.stride,w=m*this.stride,g=-1/0,O=-1,j=0;j<this.filterSize;j++)for(var S=0;S<this.filterSize;S++){var P=p+v+(d+j)*o+(w+S),_=l[P];_>g&&(g=_,O=P)}s[y*(u*c*i)+b*(u*c)+h*c+m]=g,f.push(O)}return a.set(s),this.cache={switches:f,inputShape:[n,o,i,e]},this.A=a,this.A}},{key:"getType",value:function(){return dt.maxpool}},{key:"setFilterSize",value:function(t){return this.filterSize=t,this}},{key:"getFilterSize",value:function(){return this.filterSize}},{key:"setStride",value:function(t){return this.stride=t,this}},{key:"getStride",value:function(){return this.stride}},{key:"getPadding",value:function(){return 0}}])&&Zr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(Pr);function $r(t){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$r(t)}function Gr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qr(n.key),n)}}function Jr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Jr=function(){return!!t})()}function Kr(t){return Kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kr(t)}function Yr(t,e){return Yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yr(t,e)}function Qr(t){var e=function(t){if("object"!=$r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$r(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$r(e)?e:e+""}var tn=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=function(t,e,r){return e=Kr(e),function(t,e){if(e&&("object"==$r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jr()?Reflect.construct(e,r||[],Kr(t).constructor):e.apply(t,r))}(this,e,[].concat(u)),r=t,o={A:[],X:[]},(n=Qr(n="cache"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yr(t,e)}(e,t),r=e,n=[{key:"activationAsync",value:function(t){throw new Error("Method not implemented.")}},{key:"penalty",value:function(){return this.Waa.pow(2).sum().get()[0]+this.Wax.pow(2).sum().get()[0]+this.Wya.pow(2).sum().get()[0]}},{key:"configure",value:function(){var t=this.getHeight(),e=this.getWidth(),r=this.getDepth();this.Wax=new $(e,t).setRandom(t),this.Waa=new $(e,e).setRandom(e),this.Wya=new $(r,e).setRandom(e),this.ba=new $(e,1).setZeros(),this.by=new $(r,1).setZeros(),this.dWax=new $(e,t).setZeros(),this.dWaa=new $(e,e).setZeros(),this.dWya=new $(r,e).setZeros(),this.dba=new $(e,1).setZeros(),this.dby=new $(r,1).setZeros()}},{key:"forward",value:function(t){var e=t.cols(),r=this.getWidth();this.cache={A:[],X:[]};var n=new $(r,1).setZeros();this.cache.A.push(n.clone());for(var o=[],i=0;i<e;i++){var u=t.col(i);this.cache.X.push(u.clone());var c=this.Waa.dot(n).add(this.Wax.dot(u)).add(this.ba).tanh(),a=this.Wya.dot(c).add(this.by);o.push(a),this.cache.A.push(c),n=c}return $.hstack(o)}},{key:"activation",value:function(t){return t.tanh()}},{key:"derivative",value:function(t){return t.pow(2).minusOne().multiply(-1)}},{key:"getType",value:function(){return dt.rnnlayer}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){return this.previousLayer=t,this.setHeight(t.getOutputHeight()),this.setDepth(this.getOutputHeight()),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight(),this.getDepth()]}},{key:"getOutputWidth",value:function(){return this.getWidth()}},{key:"getOutputHeight",value:function(){return this.getDepth()}},{key:"getOutputDepth",value:function(){return 1}}],n&&Gr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ke);function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function rn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cn(n.key),n)}}function nn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(nn=function(){return!!t})()}function on(t){return on=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},on(t)}function un(t,e){return un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},un(t,e)}function cn(t){var e=function(t){if("object"!=en(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==en(e)?e:e+""}var an=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=function(t,e,r){return e=on(e),function(t,e){if(e&&("object"==en(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nn()?Reflect.construct(e,r||[],on(t).constructor):e.apply(t,r))}(this,e,[].concat(u)),r=t,o={A:[],C:[],X:[],F:[],I:[],G:[],O:[]},(n=cn(n="cache"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&un(t,e)}(e,t),r=e,n=[{key:"penalty",value:function(){return this.W.pow(2).sum().get()[0]+this.U.pow(2).sum().get()[0]}},{key:"configure",value:function(){var t=this.getHeight(),e=this.getWidth();this.W=new $(4*e,t).setRandom(t),this.U=new $(4*e,e).setRandom(e),this.b=new $(4*e,1).setZeros(),this.dW=new $(4*e,t).setZeros(),this.dU=new $(4*e,e).setZeros(),this.db=new $(4*e,1).setZeros()}},{key:"forward",value:function(t){var e=t.cols(),r=this.getWidth();this.cache={A:[],C:[],X:[],F:[],I:[],G:[],O:[]};var n=new $(r,1).setZeros(),o=new $(r,1).setZeros();this.cache.A.push(n.clone()),this.cache.C.push(o.clone());for(var i=[],u=0;u<e;u++){var c=t.col(u);this.cache.X.push(c.clone());var a=this.W.dot(c).add(this.U.dot(n)).add(this.b),f=a.slice(0,r),l=a.slice(r,2*r),s=a.slice(2*r,3*r),y=a.slice(3*r,4*r),p=f.sigmoid(),b=l.sigmoid(),v=s.tanh(),h=y.sigmoid(),m=p.multiply(o).add(b.multiply(v)),d=h.multiply(m.tanh());i.push(d),this.cache.A.push(d),this.cache.C.push(m),this.cache.F.push(p),this.cache.I.push(b),this.cache.G.push(v),this.cache.O.push(h),n=d,o=m}return $.hstack(i)}},{key:"activation",value:function(t){return t.tanh()}},{key:"derivative",value:function(t){return t.pow(2).minusOne()}},{key:"getType",value:function(){return dt.lstm}},{key:"is1D",value:function(){return!0}},{key:"is3D",value:function(){return!1}},{key:"transition",value:function(t){return this.previousLayer=t,this.setHeight(t.getOutputHeight()),this.setDepth(this.getOutputHeight()),this}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getOutputWidth",value:function(){return this.getWidth()}},{key:"getOutputHeight",value:function(){return this.getWidth()}},{key:"getOutputDepth",value:function(){return 1}}],n&&rn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ke);function fn(t){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fn(t)}function ln(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sn(n.key),n)}}function sn(t){var e=function(t){if("object"!=fn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fn(e)?e:e+""}function yn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(yn=function(){return!!t})()}function pn(t){return pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pn(t)}function bn(t,e){return bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bn(t,e)}var vn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=pn(e),function(t,e){if(e&&("object"==fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yn()?Reflect.construct(e,r||[],pn(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bn(t,e)}(e,t),r=e,o=[{key:"fromJSON",value:function(t){return new Promise(function(r,n){rt.readFile(t,function(t,o){if(t)n(t);else{var i=JSON.parse(o.toString()),u=new e(i.dimensions);i.layers.forEach(function(t){var e=null;"logistic"===t.type?e=Ge:"softmax"===t.type?e=Ne:"relu"===t.type?e=fr:"softplus"===t.type?e=hr:"tanh"===t.type&&(e=rr),u.createLayer(e,function(e){e.setSize(t.size)})});var c=u.getNetwork();c.getLayers().forEach(function(t,e){t.W=new $(i.layers[e].weights.W.length,i.layers[e].weights.W[0].length,i.layers[e].weights.W),t.b=new $(i.layers[e].weights.b.length,i.layers[e].weights.b[0].length,i.layers[e].weights.b)}),r(c)}})})}}],(n=[{key:"firstLayerTransition",value:function(t){t.setWidth(this.dimensions[0])}}])&&ln(r.prototype,n),o&&ln(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Oe);function hn(t){return hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hn(t)}function mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dn(n.key),n)}}function dn(t){var e=function(t){if("object"!=hn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=hn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==hn(e)?e:e+""}function wn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(wn=function(){return!!t})()}function gn(t){return gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gn(t)}function On(t,e){return On=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},On(t,e)}var jn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=gn(e),function(t,e){if(e&&("object"==hn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wn()?Reflect.construct(e,r||[],gn(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&On(t,e)}(e,t),r=e,o=[{key:"fromJSON",value:function(t){return new Promise(function(r,n){rt.readFile(t,function(t,o){if(t)n(t);else{var i=JSON.parse(o.toString()),u=new e(i.size);i.layers.forEach(function(t){"logistic"===t.type?u.createLayer(Ge,function(e){e.setSize(t.size)}):"softmax"===t.type?u.createLayer(Ne,function(e){e.setSize(t.size)}):"relu"===t.type?u.createLayer(fr,function(e){e.setSize(t.size)}):"softplus"===t.type?u.createLayer(hr,function(e){e.setSize(t.size)}):"tanh"===t.type?u.createLayer(rr,function(e){e.setSize(t.size)}):"conv"===t.type?u.createLayer(Dr,function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride),e.setNumFilters(t.numFilters),e.setPadding(t.padding)}):"maxpool"===t.type?u.createLayer(Xr,function(e){e.setSize(t.size),e.setFilterSize(t.filterSize),e.setStride(t.stride)}):"fullyconnected"===t.type&&u.createLayer(Xr)});var c=u.getNetwork();c&&(c.getLayers().forEach(function(t,e){t.W=i.layers.W,t.b=i.layers.b}),r(c))}})})}}],(n=[{key:"firstLayerTransition",value:function(t){this.dimensions&&t.setSize(this.dimensions)}}])&&mn(r.prototype,n),o&&mn(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Oe);function Sn(t){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sn(t)}function Pn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kn(n.key),n)}}function _n(t,e,r){return(e=kn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kn(t){var e=function(t){if("object"!=Sn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Sn(e)?e:e+""}var En=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_n(this,"batchSize",0),_n(this,"t",0),_n(this,"learningRate",0)},e=[{key:"setBatchSize",value:function(t){return this.batchSize=t,this}},{key:"setT",value:function(t){return this.t=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}}],e&&Pn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function Rn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cn(n.key),n)}}function xn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xn=function(){return!!t})()}function Wn(t){return Wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wn(t)}function Dn(t,e){return Dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dn(t,e)}function Bn(t,e,r){return(e=Cn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cn(t){var e=function(t){if("object"!=Tn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tn(e)?e:e+""}var zn=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Bn(t=function(t,e,r){return e=Wn(e),function(t,e){if(e&&("object"==Tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xn()?Reflect.construct(e,r||[],Wn(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"beta1",.9),Bn(t,"beta2",.999),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dn(t,e)}(e,t),r=e,(n=[{key:"setBeta1",value:function(t){return this.beta1=t,this}},{key:"setBeta2",value:function(t){return this.beta2=t,this}},{key:"optimize",value:function(t){this.adam(t,this.learningRate,this.t)}},{key:"adam",value:function(t,e,r){t.vW=t.vW.multiply(this.beta1).add(t.gW.multiply(1-this.beta1)),t.vb=t.vb.multiply(this.beta1).add(t.gb.multiply(1-this.beta1)),t.sW=t.sW.multiply(this.beta2).add(t.sW.pow(2).multiply(1-this.beta2)),t.sb=t.sb.multiply(this.beta2).add(t.sb.pow(2).multiply(1-this.beta2));var n=t.vW.divide(1-Math.pow(this.beta1,2)),o=t.vb.divide(1-Math.pow(this.beta1,2)),i=t.sW.add(1e-8).sqrt(),u=t.sb.add(1e-8).sqrt();t.W=t.W.subtract(n.divide(i).multiply(e)),t.b=t.b.subtract(o.divide(u).multiply(e))}}])&&Rn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(En);function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function Mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ln(n.key),n)}}function Ln(t){var e=function(t){if("object"!=An(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=An(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==An(e)?e:e+""}function Fn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Fn=function(){return!!t})()}function Hn(t){return Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hn(t)}function Zn(t,e){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zn(t,e)}var Nn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Hn(e),function(t,e){if(e&&("object"==An(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Fn()?Reflect.construct(e,r||[],Hn(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zn(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.gradientDescent(t,this.learningRate)}},{key:"gradientDescent",value:function(t,e){t.W=t.W.subtract(t.gW.multiply(e)),t.b=t.b.subtract(t.b.multiply(e))}}])&&Mn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(En);function In(t){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},In(t)}function Un(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$n(n.key),n)}}function qn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(qn=function(){return!!t})()}function Vn(t){return Vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vn(t)}function Xn(t,e){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xn(t,e)}function $n(t){var e=function(t){if("object"!=In(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=In(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==In(e)?e:e+""}var Gn=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=Vn(e),function(t,e){if(e&&("object"==In(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qn()?Reflect.construct(e,r||[],Vn(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=$n(n="epsilon"))in r?Object.defineProperty(r,n,{value:1e-8,enumerable:!0,configurable:!0,writable:!0}):r[n]=1e-8,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xn(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.adagrad(t,this.learningRate)}},{key:"adagrad",value:function(t,e){t.dW=t.dW.add(t.gW.pow(2)),t.W=t.W.subtract(t.gW.multiply(e).divide(t.dW.add(this.epsilon).sqrt())),t.db=t.db.add(t.gb.pow(2)),t.b=t.b.subtract(t.gb.multiply(e).divide(t.db.add(this.epsilon).sqrt()))}}])&&Un(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(En);function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function Kn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eo(n.key),n)}}function Yn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Yn=function(){return!!t})()}function Qn(t){return Qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qn(t)}function to(t,e){return to=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},to(t,e)}function eo(t){var e=function(t){if("object"!=Jn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jn(e)?e:e+""}var ro=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=Qn(e),function(t,e){if(e&&("object"==Jn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yn()?Reflect.construct(e,r||[],Qn(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=eo(n="beta"))in r?Object.defineProperty(r,n,{value:.9,enumerable:!0,configurable:!0,writable:!0}):r[n]=.9,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&to(t,e)}(e,t),r=e,(n=[{key:"optimize",value:function(t){this.momentum(t,this.learningRate)}},{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"momentum",value:function(t,e){t.vW=t.gW.multiply(this.beta).add(t.gW.multiply(1-this.beta)),t.vb=t.gb.multiply(this.beta).add(t.gb.multiply(1-this.beta)),t.W=t.W.subtract(t.vW.multiply(e)),t.b=t.b.subtract(t.vb.multiply(e))}}])&&Kn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(En);function no(t){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},no(t)}function oo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fo(n.key),n)}}function io(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(io=function(){return!!t})()}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(t)}function co(t,e){return co=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},co(t,e)}function ao(t,e,r){return(e=fo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fo(t){var e=function(t){if("object"!=no(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=no(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==no(e)?e:e+""}var lo=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return ao(t=function(t,e,r){return e=uo(e),function(t,e){if(e&&("object"==no(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,io()?Reflect.construct(e,r||[],uo(t).constructor):e.apply(t,r))}(this,e,[].concat(n)),"alpha",.001),ao(t,"beta",.9),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&co(t,e)}(e,t),r=e,(n=[{key:"setBeta",value:function(t){return this.beta=t,this}},{key:"setAlpha",value:function(t){return this.alpha=t,this}},{key:"optimize",value:function(t){this.rmsprop(t,this.learningRate,this.alpha,this.beta)}},{key:"rmsprop",value:function(t,e,r,n){t.sW=t.sW.multiply(n).add(t.gW.pow(2).multiply(1-n)),t.sb=t.sb.multiply(n).add(t.gb.pow(2).multiply(1-n)),t.W=t.W.subtract(t.gW.multiply(r).divide(t.sW.sqrt().add(1e-8))),t.b=t.b.subtract(t.gb.multiply(r).divide(t.sb.sqrt().add(1e-8)))}}])&&oo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(En);function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}function yo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bo(n.key),n)}}function po(t,e,r){return(e=bo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bo(t){var e=function(t){if("object"!=so(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=so(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==so(e)?e:e+""}var vo=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),po(this,"regularization",1e-4),po(this,"iterations",1e3),po(this,"learningRate",.001),po(this,"verbose",!0),po(this,"verboseStep",1),po(this,"stepCallback",function(t){}),this.network=e,this.optimizer=r,this.costFunction=n},(e=[{key:"setRegularization",value:function(t){return this.regularization=t,this}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this}},{key:"setVerbose",value:function(t){return this.verbose=t,this}},{key:"setVerboseStep",value:function(t){return this.verboseStep=t,this}},{key:"setStepCallback",value:function(t){return this.stepCallback=t,this}},{key:"cost",value:function(t,e){var r=e.cols(),n=this.costFunction.loss(e,t),o=0;this.network.getLayers().forEach(function(t){o+=t.penalty().get()[0]});for(var i=n+this.regularization*o/(2*r),u=0,c=0;c<r;c+=1){var a=t.col(c).maxCoeff(),f=e.col(c).maxCoeff();a.get()[0]===f.get()[0]&&u++}return{cost:i,accuracy:u/r*100}}}])&&yo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ho(t){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ho(t)}function mo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(mo=function(){return!!t})()}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wo(t)}function go(t,e){return go=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},go(t,e)}var Oo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=wo(e),function(t,e){if(e&&("object"==ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,mo()?Reflect.construct(e,r||[],wo(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&go(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(vo);function jo(t){return jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jo(t)}function So(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Po(n.key),n)}}function Po(t){var e=function(t){if("object"!=jo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jo(e)?e:e+""}function _o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_o=function(){return!!t})()}function ko(t){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ko(t)}function Eo(t,e){return Eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Eo(t,e)}var To=function(t){function e(t,r,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=ko(e),function(t,e){if(e&&("object"==jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_o()?Reflect.construct(e,r||[],ko(t).constructor):e.apply(t,r))}(this,e,[t,r,n])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Eo(t,e)}(e,t),r=e,n=[{key:"train",value:function(t,e){var r=this,n=t.getNumberOfExamples(),o=t.data.transpose(),i=e.data.transpose(),u=0;this.optimizer.setBatchSize(n),this.optimizer.setLearningRate(this.learningRate);for(var c=0;c<this.iterations;c+=1){var a=(new Date).getTime(),f=this.network.forward(o),l=this.costFunction.derivative(i,f,this.network.getLastLayer());if(this.network.backward(o,this.regularization,l),this.optimizer.setT(++u),this.network.getLayers().forEach(function(t){r.optimizer.optimize(t)}),this.verbose&&(c+1)%this.verboseStep===0){var s=this.cost(f,i),y=(new Date).getTime();console.log("Iteration: ".concat(c+1," | Cost: ").concat(_t(s.cost,5)," | Accuracy: ").concat(_t(s.accuracy,2),"% | Time: ").concat((y-a)/1e3," s."))}this.stepCallback({iteration:c})}return this}}],n&&So(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(vo);function Ro(t){return Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(t)}function xo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xo=function(){return!!t})()}function Wo(t){return Wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wo(t)}function Do(t,e){return Do=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Do(t,e)}var Bo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Wo(e),function(t,e){if(e&&("object"==Ro(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xo()?Reflect.construct(e,r||[],Wo(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Do(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(En);function Co(t){return Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(t)}function zo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){f=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ao(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ao(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Mo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fo(n.key),n)}}function Lo(t,e,r){return(e=Fo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fo(t){var e=function(t){if("object"!=Co(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Co(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Co(e)?e:e+""}var Ho=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Lo(this,"network",null),Lo(this,"iterations",1e3),Lo(this,"learningRate",.01),Lo(this,"optimizer",null),this.network=e,this.optimizer=new Bo(e).setLearningRate(this.learningRate)},(e=[{key:"train",value:function(t){var e=zo(t.buildData(this.network.getDimensions()[0]),2),r=e[0],n=e[1],o=zo(t.vectorization(r,n),2),i=o[0],u=o[1];this.optimizer.setT(-1).setHS(new $(this.network.getDimensions()[0],this.network.getDimensions()[0]).setZeros());for(var c=0;c<this.iterations;c+=1){for(var a=0,f=0;f<r.length;f+=1){var l=this.network.forward(i[f],u[f],this.optimizer.hs[f-1]),s=l.aNext,y=l.y,p=l.loss;this.optimizer.setT(f).setHS(s).setYS(y),(f+1)%1e3==0&&console.log("FORWARD Example ".concat(f+1," | Iteration ").concat(c+1)),a+=p}console.log("Loss ".concat(a," | Iteration: ").concat(c));for(var b=r.length-1;b>=0;b-=1){for(var v=$.from(this.optimizer.ys[b].data),h=0;h<v.rows;h+=1)v.data[h][i[b].transpose().rowMaxCoeffIndex(h)]-=1;this.network.backward(i[b],v,this.optimizer.hs[b-1],this.optimizer.hs[b]),(b+1)%1e3==0&&console.log("BACKWARD Example ".concat(b+1," | Iteration ").concat(c+1))}this.optimizer.optimize(this.network.layers[0]),console.log(this.network.sample(t).trim())}return[0]}},{key:"setIterations",value:function(t){return this.iterations=t,this}},{key:"setLearningRate",value:function(t){return this.learningRate=t,this.optimizer.setLearningRate(t),this}}])&&Mo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Zo(t){return Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zo(t)}function No(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Uo(n.key),n)}}function Io(t,e,r){return e&&No(t.prototype,e),r&&No(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Uo(t){var e=function(t){if("object"!=Zo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zo(e)?e:e+""}var qo=Io(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});function Vo(t){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(t)}function Xo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$o(n.key),n)}}function $o(t){var e=function(t){if("object"!=Vo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Vo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vo(e)?e:e+""}function Go(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Go=function(){return!!t})()}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}function Ko(t,e){return Ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ko(t,e)}var Yo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Jo(e),function(t,e){if(e&&("object"==Vo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Go()?Reflect.construct(e,r||[],Jo(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ko(t,e)}(e,t),r=e,(n=[{key:"loss",value:function(t,e){var r=t.cols();return e.subtract(t).pow(2).sum().get()[0]/(2*r)}},{key:"derivative",value:function(t,e,r){return e.subtract(t).multiply(r.derivative(e))}}])&&Xo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(qo);function Qo(t){return Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qo(t)}function ti(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oi(n.key),n)}}function ei(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ei=function(){return!!t})()}function ri(t){return ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ri(t)}function ni(t,e){return ni=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ni(t,e)}function oi(t){var e=function(t){if("object"!=Qo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Qo(e)?e:e+""}var ii=function(t){function e(){var t,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return t=function(t,e,r){return e=ri(e),function(t,e){if(e&&("object"==Qo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ei()?Reflect.construct(e,r||[],ri(t).constructor):e.apply(t,r))}(this,e,[].concat(i)),r=t,(n=oi(n="epsilon"))in r?Object.defineProperty(r,n,{value:1e-8,enumerable:!0,configurable:!0,writable:!0}):r[n]=1e-8,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ni(t,e)}(e,t),r=e,(n=[{key:"loss",value:function(t,e){var r=t.cols(),n=e.add(this.epsilon).log();return-t.multiply(n).sum().get()[0]/r}},{key:"derivative",value:function(t,e,r){if(r.getType()===dt.softmax)return e.subtract(t);var n=e.multiply(e.minusOne().multiply(-1)).add(this.epsilon);return e.subtract(t).divide(n).multiply(r.derivative(e))}}])&&ti(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(qo),ui=r(928),ci=r.n(ui);function ai(t){return ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ai(t)}function fi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,si(n.key),n)}}function li(t,e,r){return(e=si(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function si(t){var e=function(t){if("object"!=ai(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ai(e)?e:e+""}var yi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),li(this,"exampleSize",0),li(this,"numberOfExamples",0),li(this,"data",null),this.exampleSize=e,this.numberOfExamples=r,n&&(this.data=n)}return e=t,n=[{key:"fromMatrix",value:function(e){var r=new t;return r.exampleSize=e.rows,r.numberOfExamples=e.cols,r.data=e,r}}],(r=[{key:"exampleAt",value:function(t){return this.data.row(t).transpose()}},{key:"getNumberOfExamples",value:function(){return this.data.rows()}},{key:"getExampleSize",value:function(){return this.data.cols()}},{key:"getBatch",value:function(e,r){var n=this.data.block(0,e,this.data.rows,r);return t.fromMatrix(n)}}])&&fi(e.prototype,r),n&&fi(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function pi(t){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pi(t)}function bi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vi(n.key),n)}}function vi(t){var e=function(t){if("object"!=pi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pi(e)?e:e+""}var hi=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"fromSource",value:function(t){return new Promise(function(e){t.then(function(t){var r=t.parse(),n=r.rows(),o=r.cols(),i=new yi(o,n,r);e(i)})})}}],null&&bi(t.prototype,null),e&&bi(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function mi(t){return mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mi(t)}function di(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gi(n.key),n)}}function wi(t,e,r){return e&&di(t.prototype,e),r&&di(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gi(t){var e=function(t){if("object"!=mi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=mi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mi(e)?e:e+""}var Oi=wi(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});function ji(t){return ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ji(t)}function Si(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pi(n.key),n)}}function Pi(t){var e=function(t){if("object"!=ji(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ji(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ji(e)?e:e+""}var _i=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"fromSource",value:function(t){return new Promise(function(e){t.then(function(t){var r=t.parse();e(new Oi(r))})})}}],null&&Si(t.prototype,null),e&&Si(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ki(t){return ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ki(t)}function Ei(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ri(n.key),n)}}function Ti(t,e,r){return e&&Ei(t.prototype,e),r&&Ei(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ri(t){var e=function(t){if("object"!=ki(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ki(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ki(e)?e:e+""}var xi=Ti(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)});const Wi=require("csvtojson");function Di(t){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Di(t)}function Bi(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fi(n.key),n)}}function zi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zi=function(){return!!t})()}function Ai(t){return Ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ai(t)}function Mi(t,e){return Mi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mi(t,e)}function Li(t,e,r){return(e=Fi(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fi(t){var e=function(t){if("object"!=Di(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Di(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Di(e)?e:e+""}var Hi=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Li(r=function(t,e,r){return e=Ai(e),function(t,e){if(e&&("object"==Di(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zi()?Reflect.construct(e,r||[],Ai(t).constructor):e.apply(t,r))}(this,e),"data",null),Li(r,"matrixData",null),r.data=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mi(t,e)}(e,t),r=e,o=[{key:"fromLocalFile",value:function(t){return new Promise(function(r){Wi({noheader:!0,output:"csv"}).fromFile(t).then(function(t){r(new e(t))})})}}],(n=[{key:"parse",value:function(){var t,e=this,r=this.data.length,n=null===(t=this.data[0])||void 0===t?void 0:t.length;if(void 0!==r&&void 0!==n){for(var o=[],i=function(){var t=[];e.data[u].forEach(function(e,r){t.push(Number(e))}),o=[].concat(function(t){return function(t){if(Array.isArray(t))return Bi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Bi(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o),t)},u=0;u<r;u+=1)i();return new $(r,n).allocate().set(new Float64Array(o))}return new $(0,0)}}])&&Ci(r.prototype,n),o&&Ci(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(xi);function Zi(t){return Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zi(t)}function Ni(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ui(n.key),n)}}function Ii(t,e,r){return e&&Ni(t.prototype,e),r&&Ni(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ui(t){var e=function(t){if("object"!=Zi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Zi(e)?e:e+""}function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Vi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ji(n.key),n)}}function Xi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Xi=function(){return!!t})()}function $i(t){return $i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$i(t)}function Gi(t,e){return Gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gi(t,e)}function Ji(t){var e=function(t){if("object"!=qi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=qi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qi(e)?e:e+""}var Ki=function(t){function e(t){var r,n,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=$i(e),function(t,e){if(e&&("object"==qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xi()?Reflect.construct(e,r||[],$i(t).constructor):e.apply(t,r))}(this,e),n=r,(o=Ji(o="data"))in n?Object.defineProperty(n,o,{value:"",enumerable:!0,configurable:!0,writable:!0}):n[o]="",r.data=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gi(t,e)}(e,t),r=e,o=[{key:"fromLocalFile",value:function(t){return new Promise(function(r,n){rt.readFile(t,function(t,o){t?n(t):r(new e(o.toString("utf-8")))})})}}],(n=[{key:"parse",value:function(){return this.data}}])&&Vi(r.prototype,n),o&&Vi(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(Ii(function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));function Yi(t){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi(t)}function Qi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eu(n.key),n)}}function tu(t,e,r){return e&&Qi(t.prototype,e),r&&Qi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function eu(t){var e=function(t){if("object"!=Yi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yi(e)?e:e+""}var ru=tu(function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=eu(n="dataset"))in r?Object.defineProperty(r,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):r[n]=null,this.dataset=e});function nu(t){return nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nu(t)}function ou(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ou=function(){return!!t})()}function iu(t){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iu(t)}function uu(t,e){return uu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},uu(t,e)}var cu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=iu(e),function(t,e){if(e&&("object"==nu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ou()?Reflect.construct(e,r||[],iu(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uu(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(ru);function au(t){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(t)}function fu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lu(n.key),n)}}function lu(t){var e=function(t){if("object"!=au(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==au(e)?e:e+""}function su(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(su=function(){return!!t})()}function yu(t){return yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yu(t)}function pu(t,e){return pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pu(t,e)}var bu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=yu(e),function(t,e){if(e&&("object"==au(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,su()?Reflect.construct(e,r||[],yu(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pu(t,e)}(e,t),r=e,(n=[{key:"apply",value:function(t){var e=t.data.minMax();return t.data=e,t}}])&&fu(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ru);function vu(t){return vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vu(t)}function hu(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gu(n.key),n)}}function mu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(mu=function(){return!!t})()}function du(t){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},du(t)}function wu(t,e){return wu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wu(t,e)}function gu(t){var e=function(t){if("object"!=vu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=vu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vu(e)?e:e+""}var Ou=function(t){function e(){var t,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return t=function(t,e,r){return e=du(e),function(t,e){if(e&&("object"==vu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,mu()?Reflect.construct(e,r||[],du(t).constructor):e.apply(t,r))}(this,e,[].concat(u)),r=t,o="mean",(n=gu(n="modificationType"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wu(t,e)}(e,t),r=e,(n=[{key:"apply",value:function(t){for(var e=[],r=0,n=0,o=0,i=0;i<t.getNumberOfExamples();i+=1)for(var u=t.exampleAt(i),c=0;c<t.getExampleSize();c+=1)isNaN(u.data[c][0])||"number"!=typeof u.data[c][0]?e.push({row:c,col:u}):(n+=u.data[c][0],r++);return"mean"===this.modificationType&&(o=n/r),e.forEach(function(e){var r=e.row,n=e.col;t.data.data[r][n]=o}),t}},{key:"setModificationType",value:function(t){return this.modificationType=t,this}}])&&hu(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ru);function ju(t){return ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(t)}function Su(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Su=function(){return!!t})()}function Pu(t){return Pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pu(t)}function _u(t,e){return _u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_u(t,e)}var ku=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Pu(e),function(t,e){if(e&&("object"==ju(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Su()?Reflect.construct(e,r||[],Pu(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_u(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(ru);function Eu(t){return Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Eu(t)}function Tu(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ru(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xu(n.key),n)}}function xu(t){var e=function(t){if("object"!=Eu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Eu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Eu(e)?e:e+""}function Wu(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Wu=function(){return!!t})()}function Du(t){return Du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Du(t)}function Bu(t,e){return Bu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bu(t,e)}var Cu=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=Du(e),function(t,e){if(e&&("object"==Eu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wu()?Reflect.construct(e,r||[],Du(t).constructor):e.apply(t,r))}(this,e,[null])).columns=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bu(t,e)}(e,t),r=e,(n=[{key:"apply",value:function(t){var e=this,r=0,n=t;return this.columns.sort().forEach(function(t){var o=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,f=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){f=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(f)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Tu(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tu(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.applyForColumn(n,t+r),2),i=o[0],u=o[1];r+=u,n=i}),t}},{key:"applyForColumn",value:function(t,e){for(var r=t.data.row(e),n=[],o=0;o<r.rows;o+=1)n.push(r.value(o,0));n=n.filter(function(t,e,r){return r.indexOf(t)===e}),t.insertColumnAfter(e,n.length-1);for(var i=0;i<t.data.cols;i+=1)for(var u=t.data.data[e][i],c=0,a=0;a<t.data.rows;a+=1)a>=e&&a<e+n.length&&(c===n.indexOf(u)?t.data.data[a][i]=1:t.data.data[a][i]=0,c+=1);return[t,n.length-1]}}])&&Ru(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(ru);function zu(t){return zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zu(t)}function Au(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Au=function(){return!!t})()}function Mu(t){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mu(t)}function Lu(t,e){return Lu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lu(t,e)}var Fu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=Mu(e),function(t,e){if(e&&("object"==zu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Au()?Reflect.construct(e,r||[],Mu(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lu(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(ru),Hu={NetworkBuilder1D:vn,NetworkBuilder3D:jn},Zu={SoftmaxLayer:Ne,LogisticLayer:Ge,ReluLayer:fr,SoftplusLayer:hr,TanhLayer:rr,ConvLayer:Dr,MaxPoolLayer:Xr,FullyConnectedLayer:Fr,RecurrentLayer:tn,LSTMLayer:an},Nu={OptimizerAdam:zn,OptimizerGradientDescent:Nn,OptimizerAdagrad:Gn,OptimizerMomentum:ro,OptimizerRMSProp:lo},Iu={MiniBatchTrainer:Oo,Trainer:To,RNNTrainer:Ho},Uu={NetworkRNN:yt,NetworkLSTM:mt},qu={MeanSquaredErrorCost:Yo,CrossEntropyCost:ii};e().setModulePath(ci().resolve(__dirname,"../"));var Vu={DatasetBuilder:hi,DatasetVocabularyBuilder:_i},Xu={Dataset:yi},$u={CallbackDatasetModifier:cu,MinMaxScalingDatasetModifier:bu,MissingDataDatasetModifier:Ou,ShuffleDatasetModifier:ku,CategoryDatasetModifier:Cu,SplitDatasetModifier:Fu},Gu={DatasetBuilderSourceCSV:Hi,DatasetVocabularyBuilderSourceTextFile:Ki},Ju={CalcScalar:S,CalcRowVector:M,CalcColVector:x,CalcMatrix2D:$,CalcMatrix3D:et,setDevice:function(t){o=t},getDevice:i,native:e()};const Ku={NetworkBuilder:Hu,Layer:Zu,Optimizer:Nu,Trainer:Iu,Network:Uu,Cost:qu,Math:Ju,DatasetBuilder:Vu,Dataset:Xu,DatasetModifier:$u,DatasetBuilderSource:Gu}})(),module.exports=n})();
//# sourceMappingURL=impulse-math-device-ts.js.map